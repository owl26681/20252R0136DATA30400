{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17987,"status":"ok","timestamp":1764416050552,"user":{"displayName":"이종원","userId":"01943472295623789309"},"user_tz":-540},"id":"NUCtw9OESD4v","outputId":"6397ce14-bbf9-4478-a144-1215dc56f364"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21660,"status":"ok","timestamp":1764416081114,"user":{"displayName":"이종원","userId":"01943472295623789309"},"user_tz":-540},"id":"9tBJPx97UPnm","outputId":"a9161e36-db80-49db-8c6f-be299f4b3aaf"},"outputs":[{"output_type":"stream","name":"stdout","text":["DATA_DIR: /content/drive/MyDrive/BDA/Amazon_products\n","DATASET: /content/drive/MyDrive/BDA/Amazon_products/train/train_corpus.txt\n","GPU: 0\n","OUT_PATH: /content/drive/MyDrive/BDA/Amazon_products/train/init_core_classes_s_test.json\n"]}],"source":["# Cell 1: imports & config\n","\n","import os\n","import json\n","import copy\n","import math\n","import queue\n","\n","import torch\n","from tqdm import tqdm\n","from sentence_transformers import SentenceTransformer\n","from sklearn.metrics.pairwise import cosine_similarity as cos\n","\n","\n","# -----------------------\n","# 하이퍼파라미터 (원하면 튜닝)\n","# -----------------------\n","TOP_K = 3          # 문서당 최대 core class 개수\n","MIN_PROB = 0.05    # softmax 확률 기준 최소값 (너무 애매한 라벨 컷)\n","USE_MARGIN = True\n","MARGIN_DELTA = 0.02  # 1등과 2등의 확률 차이가 이보다 크면 1등만 뽑도록 stop\n","\n","# -----------------------\n","# 데이터 경로 설정 (여기만 네 상황에 맞게 수정)\n","# -----------------------\n","DATA_DIR = \"/content/drive/MyDrive/BDA/Amazon_products\"      # 예: \"/content/data\"\n","DATASET = \"/content/drive/MyDrive/BDA/Amazon_products/train/train_corpus.txt\"          # document\n","GPU = 0                         # cuda 디바이스 번호\n","\n","# output 파일 이름 (원본과 헷갈리지 않게)\n","OUT_PATH = os.path.join(DATA_DIR,\"train\", \"init_core_classes_s_test.json\")\n","\n","print(\"DATA_DIR:\", DATA_DIR)\n","print(\"DATASET:\", DATASET)\n","print(\"GPU:\", GPU)\n","print(\"OUT_PATH:\", OUT_PATH)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BhoTe5paZa8v"},"outputs":[],"source":["# Cell: Node 클래스 + 그래프 생성 함수\n","\n","class Node:\n","    def __init__(self, node_id, name):\n","        self.node_id = str(node_id)       # \"0\", \"1\", ...\n","        self.name = name                  # \"grocery_gourmet_food\"\n","        self.childs = []                  # List[Node]\n","        self.parents = []                 # List[Node]\n","        self.path_score = 0.0\n","        self.similarity_score = 0.0\n","\n","    def __repr__(self):\n","        return f\"Node(id={self.node_id}, name={self.name})\"\n","\n","\n","def build_graph_from_files(label_file, edge_file):\n","    \"\"\"\n","    label_file: \"id<tab>label_name\"\n","    edge_file : \"parent_id<tab>child_id\"\n","    \"\"\"\n","    id2label = {}\n","    label2id = {}\n","    id2node = {}\n","\n","    # 1) 라벨 파일 읽기\n","    with open(label_file, encoding=\"utf-8\") as f:\n","        for line in f:\n","            line = line.strip()\n","            if not line:\n","                continue\n","            parts = line.split(\"\\t\")\n","            if len(parts) != 2:\n","                continue\n","            idx, name = parts\n","            idx = str(idx)\n","            name = name.strip()\n","            id2label[idx] = name\n","            label2id[name] = idx\n","            id2node[idx] = Node(idx, name)\n","\n","    # 2) 부모-자식 엣지 파일 읽기\n","    with open(edge_file, encoding=\"utf-8\") as f:\n","        for line in f:\n","            line = line.strip()\n","            if not line:\n","                continue\n","            parts = line.split(\"\\t\")\n","            if len(parts) != 2:\n","                continue\n","            p, c = parts\n","            p = str(p); c = str(c)\n","            if p not in id2node or c not in id2node:\n","                continue\n","            parent = id2node[p]\n","            child = id2node[c]\n","            parent.childs.append(child)\n","            child.parents.append(parent)\n","\n","    # 3) 부모가 없는 노드들 = top-level 루트들\n","    roots = [n for n in id2node.values() if len(n.parents) == 0]\n","\n","    if len(roots) == 1:\n","        root = roots[0]\n","    else:\n","        # top-level이 여러 개면 슈퍼루트 하나 만들어서 모두 연결\n","        root = Node(\"-1\", \"ROOT\")\n","        for r in roots:\n","            root.childs.append(r)\n","            r.parents.append(root)\n","\n","    print(f\"#labels: {len(id2label)}, #roots(before super-root): {len(roots)}\")\n","    return root, id2label, label2id, id2node\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Licy3UDdZuRe"},"outputs":[],"source":["import mmap\n","def get_num_lines(file_path):\n","    fp = open(file_path, \"r+\")\n","    buf = mmap.mmap(fp.fileno(), 0)\n","    lines = 0\n","    while buf.readline():\n","        lines += 1\n","    return lines"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":678,"referenced_widgets":["e29ebbe27ce0404b96e195ce1c95e1e4","538583b362174f51ba5442afbff90f1b","cc1bb5ac155d4e1b99011824a8f78c69","07ee56e34fef46fbaec7bfcc7c18ba56","2e0cba9caf0d4194b455f373ba6c1f3c","e0447209ed2a4453b244b83c472b0dbe","e5b5422e368a431ea84aa7496638591c","c741d24438a8436d8a3be575d605c71f","d2afa5e35c3643aab85425386e9a04f9","715dacdddb00445889cbc51ab9ccfb10","0aeb3a81211644f995311acdfd99417d","6c31101b384447dc86bfb1f4f9ec9c5d","9b048da7e0d349aebb24f70a68e24511","69683a1dd384481e895eb0b3f002c06e","97a2ae51d55a46c2b7b1368455d6af23","b8f5342e646f4ff482eda6eab335373f","2d175081ac664d47ae3ba0bc7be58bf5","2560348854d24233b2bef4b78a2605c9","b02632cbc4804069913b6f2ffcaa1164","4cea962048724743a0e08e1b9fe17541","e9bcd255a9ce49f5be1c2e61feabd8a2","2dd551589d594bd18e9a749629310a98","db5ecc016f9e481d8880043f623419e5","a8b59907a0944077a68214ce0a712c38","2a75a82a7f504336b853c05ece3d4087","a355eeb0034f4e45994b7468e48b4118","949325ca64e04b33ada902ba0fffdd94","fd8eec3fc5584de5977838e497dc6a75","00e63ef08520468ab6f12915c49faf2e","96e544d213884a51a02ea12c59e162cc","bf2d00af4326489992fcdae1ff644571","5e155f2be8184a47b06fe10d7a6fb3ed","c7486402d8dc4429828627cbc9071c95","fefa485e6f5748b69892fb7cd51dae6e","b2db65b79690488ca10f65c276b49b95","52919e3c4fa64ee9b433ce3e9cd95dbe","753e0f52551d48878d39302e53f80da0","3d83f39d26b940b0a0f87a5a64566f15","a8ae745fcfde453296cb1bd2e0e31e22","bd23357b5aeb4f68bbc705ef1f313289","03cbda30478f4c01b0e2484bf1343f6e","e1d861101641429db860fddd748be34e","ede5cd450ac142cf8bdb92742d178d61","9086f8c709cd4e12b24ad7bb172ff91b","37fa0890d59543ccbe5c3f02e220d11e","482ac991658b40a2903945cd0906c804","3405dc587e324b82bb87c27714827ba4","95fed309fced4c11bf6c520ad8dd5332","0a1db55e4c834ba7845081bee7982161","7a9fc2aaeff1437e8d85bba9e02fa39d","183a7983a919482a9feb067c160ce979","014d31929e004222973c79fcff081938","6239998adc964f14a0a46ef27d500592","b53f16d756314227a44464cb12d287f8","bbf16e194db144dda8291d410515c9f2","85efb8ee1c38448a9894c7b171309e32","559246501db341cc9bbab5ed14185af3","41648c5c729243a59de746af390542c2","183d680824d9445d9b03fa8b85d4e490","b21c0675fb9445119f0e48fa3a83ffba","98c9529ea33d45369007aadcabe64109","d18e3537a567406eaf60ad05afe0ad99","e80d2843809746cea81e36ea30a334a2","d567920eb8ca43b5bf9b442ce12d5f2f","4a3a9da1fc9f467a9bfaaa20b87d3f43","5a8c6c1527d4426292a244d5520aaea0","2619e17c7a97463cb95ffd11faa8ac51","6e94b9d734aa486ba30e8603437d3cb3","6a4a56fc991340f0bb0f66b64863063b","044e10dddbd847a9abda79ecc1bfee09","0ec17ec5adf64ed1aeccb766cd522201","64193da487d646c2b6556127f3df77a3","349ada69d62c4e8b8ebfb74b88bc84e6","8953ba39413044fda208e16afcbdd943","13bd51fcdcba471a9f92be3e969742e0","2a2f424a2c854cf395a5afcff7d7b225","e8fe2f1e8514404f94e4d502c784246a","43b97ccbf9cc429c8ff6f305180c72b4","99a03c49df6c42fba02b9b2201c65849","2de04f8818f24d92a10a22d2912127b8","f8851858b3b848d79359c7dec79e5e0e","88427a1b309548ada912ed02d308ca57","a530937fcd664f9b9e3937894eb285fb","a6deed6dbb7a4d08aa164e3ffb033721","315d249fcf904124899f98c0c5417062","bda45bb983e74b668659f9f2aae7f8f9","b08bd5ffa9c847b89d0a8410344dbb03","7864683a6fad41f99b2a63e0b2b2caee","07c20c5afc8b41c8b7e96e08ee84ffda","85942c1504ba4b7da78e797def970639","5512dc4da5fd4225b0c138a7bb49493b","f234908d00b6430f810fa6e06bd0942a","db12ec1d0efd436481c9f60e2eeea5b0","983f422d181646218912b6a126b8f790","f27abc9608b544139eff58e6718a5d14","0fa0332ab62d4f32828531a3b4afa812","cb0e8286f4ed4398878bbaf8ef8c3a9a","37850fe272b048b5964395e987cd7292","ece5cb7a476a43c594ea00875b0d5773","eec62e206f7249e8b4be7120c27f5ecf","ead444bbbb3f47f8aa9d1e0f59e24621","9110756ab23f4de0959c74ec87d56541","6b55b951c222416ab318317602c7526a","d093e89607234011a0446b241c44d452","8cd7c26cb2e54fbcb20429426c08e534","ef72e7f9a2e54e6cb50db275688ba319","4a85e4644f974eb890bb6a8edd0d628f","427a62ed7bcf436fa6140a9c932044d5","131d02df13734443b619964ce3c55bb2","d392029691a14bfc82b8fbef46bea23a","3e72b7da61644ef5befb16df7111ba75","36fead8903064dc19517ef8b007579c4","4d6479c572cd4e52a5b4d2ba5989d76f","7250c2bb2cae4b34858ba82f4cf58325","54e5e1e9e94f4556ac9dcf3c67bdf46e","b512ecd6e5a14bed84964fb8ab2688e1","cdb1ececb2594652b7e36b1b96a2eb64","6f574d6e4afb4e68b4398f2f34e747f6","2910b7fce56841c783d6654e264eb708","ab65d8cf3eb746afa77fe3de1d17a53b","b0a2ae13a0e145b4a02383e34816cadd","e06c45de4e714d6da1923b9fe54bcc99","72f60541067b41219f9e746e0100174f","f09771b7b5534ae6a674158d4c30d40e","bec5b5dc73504f6f892c34452ee0d7d0","19c0206d635049c68c17f1ec71c4ea82","f709a0c635e647839907d4c31c4d1561","d85847306cef418a808a265f62b6f950","ad85f4a94d154899a2fe9e3068962fa4","aa4341c5e397471688198cb873bb970b","5057fa911f83459c8993465b56918737","6b3664b79a2d4e8d94d926c9daed028c"]},"executionInfo":{"elapsed":129352,"status":"ok","timestamp":1764416235292,"user":{"displayName":"이종원","userId":"01943472295623789309"},"user_tz":-540},"id":"dk5N01RQUOnD","outputId":"74f1e492-b90b-4666-c843-ac93c960faf0"},"outputs":[{"output_type":"stream","name":"stdout","text":["num labels with keywords: 531\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.12/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["modules.json:   0%|          | 0.00/349 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e29ebbe27ce0404b96e195ce1c95e1e4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config_sentence_transformers.json:   0%|          | 0.00/116 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6c31101b384447dc86bfb1f4f9ec9c5d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["README.md: 0.00B [00:00, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"db5ecc016f9e481d8880043f623419e5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["sentence_bert_config.json:   0%|          | 0.00/53.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fefa485e6f5748b69892fb7cd51dae6e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/571 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"37fa0890d59543ccbe5c3f02e220d11e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/438M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"85efb8ee1c38448a9894c7b171309e32"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/363 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2619e17c7a97463cb95ffd11faa8ac51"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt: 0.00B [00:00, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"43b97ccbf9cc429c8ff6f305180c72b4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json: 0.00B [00:00, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"07c20c5afc8b41c8b7e96e08ee84ffda"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["special_tokens_map.json:   0%|          | 0.00/239 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"eec62e206f7249e8b4be7120c27f5ecf"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/190 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3e72b7da61644ef5befb16df7111ba75"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Loaded SentenceTransformer: all-mpnet-base-v2\n","#labels: 531, #roots(before super-root): 6\n","num_class: 531\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 29487/29487 [00:00<00:00, 617692.31it/s]\n"]},{"output_type":"stream","name":"stdout","text":["num_docs: 29487\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/231 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e06c45de4e714d6da1923b9fe54bcc99"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["100%|██████████| 531/531 [00:06<00:00, 79.88it/s]"]},{"output_type":"stream","name":"stdout","text":["built key_term_emb_dict for all labels\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["# Cell 2: graph, corpus, embedding 준비\n","\n","# 1) 라벨 키워드 로드 (llm_enrichment.txt)\n","enriched_file = os.path.join(DATA_DIR, \"class_related_keywords.txt\")\n","label_keyterm_dict = {}\n","\n","with open(enriched_file, encoding=\"utf-8\") as f:\n","    for line in f:\n","        line = line.strip()\n","        if not line:\n","            continue\n","        components = line.split(\":\")\n","        node = components[0]          # label_name (with underscore)\n","        keywords = components[1]\n","        keyword_list = [k for k in keywords.split(\",\") if k]\n","        label_keyterm_dict[node] = keyword_list\n","\n","print(\"num labels with keywords:\", len(label_keyterm_dict))\n","\n","# 2) SentenceTransformer 모델 로드\n","model_name = \"all-mpnet-base-v2\"\n","model = SentenceTransformer(model_name, device=f\"cuda:{GPU}\")\n","print(\"Loaded SentenceTransformer:\", model_name)\n","\n","# 3) taxonomy 그래프 로드\n","LABEL_FILE = os.path.join(DATA_DIR, \"classes.txt\")      # 예시 이름\n","EDGE_FILE  = os.path.join(DATA_DIR, \"class_hierarchy.txt\") # 예시 이름\n","\n","root, id2label, label2id, id2node = build_graph_from_files(LABEL_FILE, EDGE_FILE)\n","\n","num_class = len(id2label)\n","print(\"num_class:\", num_class)\n","# 4) corpus.txt 로드: \"doc_id \\t text\"\n","corpus_path = os.path.join(DATASET)\n","num_line = get_num_lines(corpus_path)\n","\n","all_docs = []\n","all_docs_id = []\n","\n","with open(corpus_path, encoding=\"utf-8\") as f:\n","    for i, line in tqdm(enumerate(f), total=num_line):\n","        line = line.rstrip(\"\\n\")\n","        if not line:\n","            continue\n","        doc_id, doc = line.split(\"\\t\", 1)\n","        all_docs.append(doc)\n","        all_docs_id.append(doc_id)\n","\n","print(\"num_docs:\", len(all_docs))\n","\n","# 5) 모든 문서 임베딩 계산\n","with torch.no_grad():\n","    total_doc_embedding = model.encode(\n","        all_docs,\n","        batch_size=128,\n","        show_progress_bar=True,\n","        convert_to_numpy=True,\n","    )\n","\n","# 6) 각 라벨의 key-term 임베딩 계산\n","key_term_emb_dict = {}\n","for i in tqdm(range(num_class)):\n","    current_label = id2label[str(i)]           # 예: \"hair_care\"\n","    # label 본인 + keyterms\n","    current_key = [current_label] + label_keyterm_dict[current_label]\n","    current_key = [k.replace(\"_\", \" \") for k in current_key]\n","    current_embed = model.encode(\n","        current_key,\n","        batch_size=128,\n","        convert_to_numpy=True,\n","    )  # (num_keyterms_for_label, dim)\n","    key_term_emb_dict[current_label] = current_embed\n","\n","print(\"built key_term_emb_dict for all labels\")\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":61,"status":"ok","timestamp":1764416235363,"user":{"displayName":"이종원","userId":"01943472295623789309"},"user_tz":-540},"id":"D_kJ30sNZ0T9","outputId":"8d73076f-306f-44ff-b766-463f375fb328"},"outputs":[{"output_type":"stream","name":"stdout","text":["label_emb shape: (531, 768)\n"]}],"source":["# Cell 3: label_emb 만들기 (라벨별 key-term 평균)\n","\n","import numpy as np\n","\n","dim = next(iter(key_term_emb_dict.values())).shape[1]\n","label_emb = np.zeros((num_class, dim), dtype=np.float32)\n","\n","for i in range(num_class):\n","    label_name = id2label[str(i)]  # 예: \"hair_care\"\n","    term_emb = key_term_emb_dict[label_name]  # (num_terms, dim)\n","    label_emb[i] = term_emb.mean(axis=0)\n","\n","print(\"label_emb shape:\", label_emb.shape)  # (num_class, dim)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DLrwx1VhaVS9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1764416235380,"user_tz":-540,"elapsed":14,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"d7282be7-1c69-4206-d67d-0a862a088510"},"outputs":[{"output_type":"stream","name":"stdout","text":["adj_upper shape: (531, 531)\n","built parents & siblings\n","[0, 3, 10, 23, 40, 169]\n"]}],"source":["# Cell 4: adjacency matrix + parents/siblings\n","\n","adj_upper = np.zeros((num_class, num_class), dtype=np.int32)\n","\n","with open(EDGE_FILE, encoding=\"utf-8\") as f:\n","    for line in f:\n","        line = line.strip()\n","        if not line:\n","            continue\n","        p_str, c_str = line.split(\"\\t\")\n","        p = int(p_str)\n","        c = int(c_str)\n","        adj_upper[p, c] = 1\n","\n","\n","print(\"adj_upper shape:\", adj_upper.shape)\n","\n","# ----- 위에서 이미 정의했던 함수들을 그대로 사용 -----\n","import numpy as np\n","\n","def build_parents_children(adj: np.ndarray):\n","    C = adj.shape[0]\n","    parents = [np.flatnonzero(adj[:, j]).astype(np.int64) for j in range(C)]\n","    children = [np.flatnonzero(adj[j]).astype(np.int64) for j in range(C)]\n","    return parents, children\n","\n","def build_siblings(parents, children):\n","    C = len(parents)\n","    sibs = [set() for _ in range(C)]\n","    for c in range(C):\n","        for p in parents[c]:\n","            for ch in children[p]:\n","                if ch != c:\n","                    sibs[c].add(int(ch))\n","    sibs = [np.array(sorted(s), dtype=np.int64) for s in sibs]\n","    return sibs\n","\n","parents, children = build_parents_children(adj_upper)\n","siblings = build_siblings(parents, children)\n","roots = [i for i, ps in enumerate(parents) if len(ps) == 0]\n","\n","print(\"built parents & siblings\")\n","print(roots)\n"]},{"cell_type":"code","source":["\n","def hierarchical_beam_similarity_avg(\n","    doc_vec: np.ndarray,\n","    label_emb: np.ndarray,\n","    adj_upper: np.ndarray,\n","    roots: list[int] = [0],       # 여러 루트\n","    beam: int = 5,\n","    per_parent: str | int = \"l+2\",\n","    tau: float = 0.35,\n","    eps: float = 1e-9,\n","    max_depth: int | None = None,\n","    normalize: bool = False,      # 필요하면 True로\n","):\n","    doc = np.asarray(doc_vec, dtype=np.float32)\n","    L = np.asarray(label_emb, dtype=np.float32)\n","    A = np.asarray(adj_upper).astype(bool)\n","    N, d = L.shape\n","\n","    if normalize:\n","        doc = doc / (np.linalg.norm(doc) + eps)\n","        L = L / (np.linalg.norm(L, axis=1, keepdims=True) + eps)\n","\n","    # 로컬 점수\n","    sims = L @ doc\n","    p = 1.0 / (1.0 + np.exp(-sims / max(tau, 1e-6)))\n","\n","    children = [np.flatnonzero(A[i]) for i in range(N)]\n","\n","    S = np.full(N, -np.inf, dtype=np.float32)\n","    K = np.full(N, -np.inf, dtype=np.float32)\n","    Llen = np.zeros(N, dtype=np.int32)\n","\n","    roots = list(roots)\n","    for r in roots:\n","        S[r] = 0.0\n","        Llen[r] = 0\n","        K[r] = -np.inf\n","\n","    levels = [roots[:]]\n","    cur = roots[:]\n","    level_id = 0\n","\n","    while True:\n","        cand_best = {}\n","        if isinstance(per_parent, str) and per_parent.startswith(\"l+\"):\n","            # \"l+2\", \"l+4\" 등 일반 처리\n","            offset = int(per_parent[2:])\n","            k_parent = level_id + offset\n","        else:\n","            k_parent = int(per_parent)\n","\n","        for par in cur:\n","            ch = children[par]\n","            if ch.size == 0:\n","                continue\n","            if ch.size > k_parent:\n","                idx = np.argpartition(-sims[ch], k_parent - 1)[:k_parent]\n","                ch = ch[idx]\n","            for c in ch:\n","                S_c = S[par] + float(p[c])\n","                L_c = Llen[par] + 1\n","                K_c = S_c / (L_c + eps)\n","                if (c not in cand_best) or (K_c > cand_best[c][2]):\n","                    cand_best[c] = (S_c, L_c, K_c)\n","\n","        if not cand_best:\n","            break\n","\n","        kept = sorted(cand_best.items(), key=lambda x: x[1][2], reverse=True)[:min(beam, len(cand_best))]\n","        next_level = [i for i, _ in kept]\n","        for i, (Si, Li, Ki) in kept:\n","            S[i], Llen[i], K[i] = Si, Li, Ki\n","\n","        levels.append(next_level)\n","        cur = next_level\n","        level_id += 1\n","        if max_depth is not None and level_id >= max_depth:\n","            break\n","\n","    return K, levels, sims, p"],"metadata":{"id":"gtkTTbXsF6KA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 이미 이전 셀/파일에 있다고 가정하는 함수들\n","# - hierarchical_beam_similarity_avg\n","# - compute_conf_doc\n","\n","def compute_conf_doc(\n","    sims: np.ndarray,\n","    cand: np.ndarray,\n","    parents,\n","    siblings,\n",") -> np.ndarray:\n","    conf = np.empty_like(cand, dtype=np.float32)\n","    for k, c in enumerate(cand):\n","        par = parents[c]\n","        sib = siblings[c]\n","        neigh_vals = []\n","\n","        if len(par) > 0:\n","            neigh_vals.append(sims[par].max())\n","        if len(sib) > 0:\n","            neigh_vals.append(sims[sib].max())\n","\n","        neigh_max = max(neigh_vals) if neigh_vals else 0.0\n","        conf[k] = float(sims[c] - neigh_max)\n","    return conf\n"],"metadata":{"id":"m4Mq_4JHFXXD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","from typing import List\n","\n","def make_initial_core_path_median(\n","    docs,\n","    label_emb,\n","    adj_upper,\n","    roots,\n","    beam=15,\n","    per_parent=\"l+4\",\n","    tau=0.35,\n","    p_threshold=0.0,\n","    min_path=0.0,\n","    eps=1e-9,\n","    topk=2,          # ⬅⬅ 여기 추가: 문서당 최대 몇 개 core 뽑을지\n","):\n","    \"\"\"\n","    - hierarchical_beam_similarity_avg를 돌려서\n","      path score(K) 기반 initial core를 median으로 필터링하는 버전.\n","    - cand 조건:\n","        1) beam search를 통해 방문된 노드\n","        2) (옵션) p(D,c) >= p_threshold\n","    - 최종 core 조건:\n","        1) K(D,c) >= median_path[c]\n","        2) K(D,c) >= min_path\n","      → 이 조건을 만족하는 것들 중 path score가 가장 큰 하나를 core로 선택.\n","        (아예 없으면 core 없음)\n","    \"\"\"\n","\n","    N_docs = docs.shape[0]\n","    C = label_emb.shape[0]\n","\n","    # 라벨별 path score 모으기\n","    path_per_label: list[list[float]] = [[] for _ in range(C)]\n","\n","    # 문서별 candidate / path score 저장\n","    cand_per_doc: list[np.ndarray] = []\n","    path_per_doc: list[np.ndarray] = []\n","\n","    # ---------- 1st pass: beam + (K, p) 수집 ----------\n","    for d_idx in range(N_docs):\n","        doc_vec = docs[d_idx]\n","\n","        K, levels, sims, p = hierarchical_beam_similarity_avg(\n","            doc_vec,\n","            label_emb,\n","            adj_upper,\n","            roots=list(roots),\n","            beam=beam,\n","            per_parent=per_parent,\n","            tau=tau,\n","            eps=eps,\n","            max_depth=None,\n","            normalize=False,\n","        )\n","\n","        # beam에서 방문한 라벨들을 candidate로\n","        visited = sorted({int(c) for lvl in levels for c in lvl})\n","        root_set = set(roots)\n","        cand = [c for c in visited if (c not in root_set) and np.isfinite(K[c])]\n","        cand = np.array(cand, dtype=np.int64)\n","\n","        if cand.size == 0:\n","            cand_per_doc.append(cand)\n","            path_per_doc.append(np.zeros(0, dtype=np.float32))\n","            continue\n","\n","        sims_doc = sims        # [C]\n","        p_doc    = p           # [C]\n","\n","        # (옵션) p-threshold 적용: p >= p_threshold 인 것만 남김\n","        if p_threshold > 0.0:\n","            mask_thr = p_doc[cand] >= p_threshold\n","            cand = cand[mask_thr]\n","\n","        if cand.size == 0:\n","            cand_per_doc.append(cand)\n","            path_per_doc.append(np.zeros(0, dtype=np.float32))\n","            continue\n","\n","        # 이 문서에서의 path score\n","        path_cand = np.array([K[c] for c in cand], dtype=np.float32)\n","\n","        # 라벨별 path score 목록에 추가\n","        for c, k_val in zip(cand, path_cand):\n","            path_per_label[c].append(float(k_val))\n","\n","        cand_per_doc.append(cand)\n","        path_per_doc.append(path_cand)\n","\n","    # ---------- 라벨별 median(path score) 계산 ----------\n","    median_path = np.full(C, np.inf, dtype=np.float32)\n","    for c in range(C):\n","        vals = path_per_label[c]\n","        if len(vals) == 0:\n","            continue\n","        median_path[c] = float(np.median(vals))\n","\n","    # ---------- 2nd pass: median + min_path 기준으로 core 확정 ----------\n","    core_labels_primary = np.full(N_docs, -1, dtype=np.int32)\n","    core_path_primary   = np.zeros(N_docs, dtype=np.float32)\n","\n","    core_labels_multi = [[] for _ in range(N_docs)]  # 문서별 core 라벨 리스트\n","    core_path_multi   = [[] for _ in range(N_docs)]  # 문서별 path score 리스트\n","\n","    for d_idx, (cand, path_cand) in enumerate(zip(cand_per_doc, path_per_doc)):\n","        if cand.size == 0:\n","            continue\n","\n","        kept = []\n","        for c, k_val in zip(cand, path_cand):\n","            if not np.isfinite(k_val):\n","                continue\n","            if k_val < median_path[c]:  # 라벨별 median 기준\n","                continue\n","            if k_val < min_path:        # 전역 path 기준\n","                continue\n","            kept.append((int(c), float(k_val)))\n","\n","        if not kept:\n","            continue\n","\n","        # path score 기준으로 정렬 후, 상위 topk개 선택\n","        kept.sort(key=lambda x: x[1], reverse=True)\n","        selected = kept[:topk]\n","\n","        # 대표 core 1개 (가장 높은 것) -> 기존 통계/코드용\n","        best_c, best_k = selected[0]\n","        core_labels_primary[d_idx] = best_c\n","        core_path_primary[d_idx]   = best_k\n","\n","        # multi-core 리스트 (문서당 최대 topk개)\n","        core_labels_multi[d_idx] = [c for c, _ in selected]\n","        core_path_multi[d_idx]   = [k for _, k in selected]\n","\n","    return core_labels_primary, core_path_primary, core_labels_multi, core_path_multi, median_path\n"],"metadata":{"id":"NQRoetaEFXZI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Cell 6: 전체 문서에 대해 initial core class 계산 (median 기반)\n","\n","docs_np = total_doc_embedding.astype(np.float32)\n","num_docs = docs_np.shape[0]\n","\n","# roots가 정수 id 리스트가 되게만 맞춰줘야 함\n","# 예: build_parents_children(adj_upper)로 다시 roots 뽑았으면:\n","# roots = [i for i, ps in enumerate(parents) if len(ps) == 0]\n","\n","core_labels, core_path, core_labels_multi, core_path_multi, median_path = \\\n","    make_initial_core_path_median(\n","        docs=docs_np,\n","        label_emb=label_emb,\n","        adj_upper=adj_upper,\n","        roots=roots,\n","        beam=15,\n","        per_parent=\"l+4\",\n","        tau=0.35,\n","        p_threshold=0.7,\n","        min_path=0.5,\n","        topk=2,      # ⬅⬅ 여기!\n","    )\n","\n","print(\"num_docs with core:\", np.sum(core_labels != -1))\n","print(\"num_labels with core:\", len(set(core_labels[core_labels != -1])))\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"soWA9jW_FXb5","executionInfo":{"status":"ok","timestamp":1764416296799,"user_tz":-540,"elapsed":61360,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"926fb721-b4c3-4fd3-a1ae-4401ed67c9a8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["num_docs with core: 20200\n","num_labels with core: 350\n"]}]},{"cell_type":"code","source":["import numpy as np\n","from collections import Counter\n","\n","def compute_depths(parents, children):\n","    \"\"\"\n","    parents, children : 길이 C 리스트 (각 원소는 np.ndarray of parent/child indices)\n","    root(부모 없는 노드)의 depth = 0 으로 두고 BFS로 depth 계산\n","    \"\"\"\n","    C = len(parents)\n","    depth = np.full(C, -1, dtype=np.int32)\n","\n","    from collections import deque\n","    q = deque()\n","\n","    # 부모 없는 노드들 = 루트들\n","    for c in range(C):\n","        if len(parents[c]) == 0:\n","            depth[c] = 0\n","            q.append(c)\n","\n","    while q:\n","        p = q.popleft()\n","        for ch in children[p]:\n","            if depth[ch] == -1 or depth[ch] > depth[p] + 1:\n","                depth[ch] = depth[p] + 1\n","                q.append(ch)\n","    return depth\n","\n","\n","def describe_init_cores_multi(\n","    core_labels_multi,          # List[List[int]]  문서별 core label id 리스트\n","    core_path_multi,            # List[List[float]] 문서별 core path score 리스트\n","    median_path: np.ndarray,    # [C], label-wise median path score (inf = 없음)\n","    parents,\n","    children,\n","    id2label=None,              # dict[str -> name], optional\n","):\n","    \"\"\"\n","    multi-core(init_core_class_s) 기준 통계 출력\n","    - 문서당 여러 core가 있을 수 있음\n","    \"\"\"\n","    num_docs = len(core_labels_multi)\n","    num_classes = median_path.shape[0]\n","\n","    # -------- 1) 문서 기준 --------\n","    num_cores_per_doc = np.array([len(cores) for cores in core_labels_multi], dtype=np.int32)\n","    num_docs_with_core = int(np.sum(num_cores_per_doc > 0))\n","    ratio_docs_with_core = num_docs_with_core / num_docs if num_docs > 0 else 0.0\n","\n","    print(\"=== Document-level stats (multi-core) ===\")\n","    print(f\"#docs              : {num_docs}\")\n","    print(f\"#docs with >=1 core: {num_docs_with_core} ({ratio_docs_with_core:.4f})\")\n","\n","    if num_docs_with_core > 0:\n","        qs_nd = np.percentile(num_cores_per_doc[num_cores_per_doc > 0], [0, 25, 50, 75, 90, 95, 100])\n","        print(\"num_cores_per_doc (for docs with >=1 core):\")\n","        print(f\"  min   = {qs_nd[0]:.1f}\")\n","        print(f\"  25%   = {qs_nd[1]:.1f}\")\n","        print(f\"  median= {qs_nd[2]:.1f}\")\n","        print(f\"  75%   = {qs_nd[3]:.1f}\")\n","        print(f\"  90%   = {qs_nd[4]:.1f}\")\n","        print(f\"  95%   = {qs_nd[5]:.1f}\")\n","        print(f\"  max   = {qs_nd[6]:.1f}\")\n","    print()\n","\n","    # path score 전체 분포 (모든 core instance 기준)\n","    all_path_scores = np.array(\n","        [p for paths in core_path_multi for p in paths],\n","        dtype=np.float32,\n","    )\n","    print(\"core_path stats (over all core instances):\")\n","    if all_path_scores.size > 0:\n","        qs = np.percentile(all_path_scores, [0, 25, 50, 75, 90, 95, 100])\n","        print(f\"  count = {all_path_scores.size}\")\n","        print(f\"  min   = {qs[0]:.4f}\")\n","        print(f\"  25%   = {qs[1]:.4f}\")\n","        print(f\"  median= {qs[2]:.4f}\")\n","        print(f\"  75%   = {qs[3]:.4f}\")\n","        print(f\"  90%   = {qs[4]:.4f}\")\n","        print(f\"  95%   = {qs[5]:.4f}\")\n","        print(f\"  max   = {qs[6]:.4f}\")\n","        print(f\"  mean  = {all_path_scores.mean():.4f}\")\n","        print(f\"  std   = {all_path_scores.std():.4f}\")\n","    else:\n","        print(\"  no cores at all.\")\n","    print()\n","\n","    # -------- 2) 라벨 기준 --------\n","    label_counter = Counter()\n","    for cores in core_labels_multi:\n","        label_counter.update(cores)\n","\n","    print(\"=== Label-level stats (multi-core) ===\")\n","    if len(label_counter) == 0:\n","        print(\"No cores at all (no labels selected).\")\n","    else:\n","        unique_labels = np.array(list(label_counter.keys()), dtype=np.int32)\n","        counts = np.array(list(label_counter.values()), dtype=np.int32)\n","\n","        num_labels_with_core = unique_labels.size\n","        ratio_labels_with_core = num_labels_with_core / num_classes if num_classes > 0 else 0.0\n","\n","        print(f\"#classes           : {num_classes}\")\n","        print(f\"#classes with core : {num_labels_with_core} ({ratio_labels_with_core:.4f})\")\n","\n","        qs_cnt = np.percentile(counts, [0, 25, 50, 75, 90, 95, 100])\n","        print(\"core_count per label (over labels with >=1 core instance):\")\n","        print(f\"  min   = {qs_cnt[0]:.1f}\")\n","        print(f\"  25%   = {qs_cnt[1]:.1f}\")\n","        print(f\"  median= {qs_cnt[2]:.1f}\")\n","        print(f\"  75%   = {qs_cnt[3]:.1f}\")\n","        print(f\"  90%   = {qs_cnt[4]:.1f}\")\n","        print(f\"  95%   = {qs_cnt[5]:.1f}\")\n","        print(f\"  max   = {qs_cnt[6]:.1f}\")\n","\n","        # 상위 20개 라벨\n","        print(\"\\nTop 20 labels by core_count:\")\n","        top_idx = np.argsort(-counts)[:20]\n","        for rank, idx in enumerate(top_idx, start=1):\n","            c = int(unique_labels[idx])\n","            cnt = int(counts[idx])\n","            if id2label is not None:\n","                name = id2label.get(str(c), str(c))\n","            else:\n","                name = str(c)\n","            print(f\"  {rank:2d}. label {c:4d} ({name}) : {cnt}\")\n","    print()\n","\n","    # -------- 3) median_path 분포 --------\n","    mask_finite = np.isfinite(median_path)\n","    median_vals = median_path[mask_finite]\n","    print(\"=== median_path stats (labels with finite median) ===\")\n","    print(f\"#labels with finite median: {median_vals.size}\")\n","    if median_vals.size > 0:\n","        qs_m = np.percentile(median_vals, [0, 25, 50, 75, 90, 95, 100])\n","        print(f\"  min   = {qs_m[0]:.4f}\")\n","        print(f\"  25%   = {qs_m[1]:.4f}\")\n","        print(f\"  median= {qs_m[2]:.4f}\")\n","        print(f\"  75%   = {qs_m[3]:.4f}\")\n","        print(f\"  90%   = {qs_m[4]:.4f}\")\n","        print(f\"  95%   = {qs_m[5]:.4f}\")\n","        print(f\"  max   = {qs_m[6]:.4f}\")\n","    print()\n","\n","    # -------- 4) depth 기준 통계 --------\n","    depth = compute_depths(parents, children)\n","\n","    print(\"=== Depth-level stats (multi-core) ===\")\n","    if len(label_counter) == 0:\n","        print(\"No cores → depth stats not available.\")\n","        return\n","\n","    # (1) core instance 기준 depth 분포\n","    depth_core_instances = []\n","    depth_to_docs = {}  # depth별로, 그 depth에 core를 가진 doc index set\n","\n","    for d_idx, cores in enumerate(core_labels_multi):\n","        for c in cores:\n","            d = int(depth[c])\n","            depth_core_instances.append(d)\n","            depth_to_docs.setdefault(d, set()).add(d_idx)\n","\n","    depth_core_instances = np.array(depth_core_instances, dtype=np.int32)\n","    u_d_inst, inst_counts = np.unique(depth_core_instances, return_counts=True)\n","\n","    print(\"core instances per depth:\")\n","    for d, cnt in zip(u_d_inst, inst_counts):\n","        print(f\"  depth {int(d):2d}: {int(cnt)} core instances\")\n","\n","    print(\"\\n#docs with >=1 core at each depth:\")\n","    for d in sorted(depth_to_docs.keys()):\n","        print(f\"  depth {int(d):2d}: {len(depth_to_docs[d])} docs\")\n","\n","    # (2) core를 가진 라벨 기준 depth 분포\n","    core_labels_unique = np.array(list(label_counter.keys()), dtype=np.int32)\n","    depth_labels = depth[core_labels_unique]\n","    u_d_lab, d_lab_counts = np.unique(depth_labels, return_counts=True)\n","    print(\"\\n#labels with core per depth:\")\n","    for d, cnt in zip(u_d_lab, d_lab_counts):\n","        print(f\"  depth {int(d):2d}: {int(cnt)} labels\")\n"],"metadata":{"id":"T7UsZftTRtHh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["describe_init_cores_multi(\n","    core_labels_multi=core_labels_multi,\n","    core_path_multi=core_path_multi,\n","    median_path=median_path,\n","    parents=parents,\n","    children=children,\n","    id2label=id2label,     # 필요 없으면 빼도 됨\n",")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JXcy3UTDRt8N","executionInfo":{"status":"ok","timestamp":1764416296939,"user_tz":-540,"elapsed":13,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"b38258bd-1a46-4a6b-9f5d-f7af9d00b903"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["=== Document-level stats (multi-core) ===\n","#docs              : 29487\n","#docs with >=1 core: 20200 (0.6850)\n","num_cores_per_doc (for docs with >=1 core):\n","  min   = 1.0\n","  25%   = 2.0\n","  median= 2.0\n","  75%   = 2.0\n","  90%   = 2.0\n","  95%   = 2.0\n","  max   = 2.0\n","\n","core_path stats (over all core instances):\n","  count = 35630\n","  min   = 0.6504\n","  25%   = 0.7313\n","  median= 0.7491\n","  75%   = 0.7686\n","  90%   = 0.7880\n","  95%   = 0.8004\n","  max   = 0.8554\n","  mean  = 0.7507\n","  std   = 0.0278\n","\n","=== Label-level stats (multi-core) ===\n","#classes           : 531\n","#classes with core : 395 (0.7439)\n","core_count per label (over labels with >=1 core instance):\n","  min   = 1.0\n","  25%   = 7.0\n","  median= 27.0\n","  75%   = 95.0\n","  90%   = 262.0\n","  95%   = 379.3\n","  max   = 1978.0\n","\n","Top 20 labels by core_count:\n","   1. label   34 (stuffed_animals_plush) : 1978\n","   2. label  220 (fragrance) : 1294\n","   3. label   17 (dolls_accessories) : 792\n","   4. label   60 (tools_accessories) : 760\n","   5. label  486 (cloth_diaper_accessories) : 710\n","   6. label  131 (diapering) : 628\n","   7. label  199 (dogs) : 596\n","   8. label  242 (men_s) : 584\n","   9. label   64 (hair_care) : 567\n","  10. label   55 (cleansers) : 552\n","  11. label   65 (styling_products) : 534\n","  12. label  208 (gourmet_gifts) : 530\n","  13. label    4 (games) : 528\n","  14. label   18 (dolls) : 477\n","  15. label   43 (shaving_hair_removal) : 462\n","  16. label   89 (vitamins_supplements) : 440\n","  17. label   76 (baby_child_care) : 439\n","  18. label   67 (body) : 399\n","  19. label  223 (treats) : 380\n","  20. label  109 (makeup_remover) : 380\n","\n","=== median_path stats (labels with finite median) ===\n","#labels with finite median: 465\n","  min   = 0.6501\n","  25%   = 0.7030\n","  median= 0.7135\n","  75%   = 0.7219\n","  90%   = 0.7315\n","  95%   = 0.7384\n","  max   = 0.7628\n","\n","=== Depth-level stats (multi-core) ===\n","core instances per depth:\n","  depth  1: 12664 core instances\n","  depth  2: 22966 core instances\n","\n","#docs with >=1 core at each depth:\n","  depth  1: 11436 docs\n","  depth  2: 17716 docs\n","\n","#labels with core per depth:\n","  depth  1: 57 labels\n","  depth  2: 338 labels\n"]}]},{"cell_type":"markdown","metadata":{"id":"eeXUuOqRaGL7"},"source":[]},{"cell_type":"code","source":[],"metadata":{"id":"nDeOsAgcq-Qs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# initial_labels_multi: List[List[int]]  (initial core만 쓴 멀티라벨)\n","# all_docs             : List[str]\n","# all_docs_id          : List[str]\n","\n","labeled_idx = [i for i, labs in enumerate(core_labels_multi) if len(labs) > 0]\n","\n","train_texts  = [all_docs[i] for i in labeled_idx]\n","train_docids = [all_docs_id[i] for i in labeled_idx]\n","train_labels = [core_labels_multi[i] for i in labeled_idx]\n","print(\"num labeled docs:\", len(train_texts))\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MzLkHpWDXql6","executionInfo":{"status":"ok","timestamp":1764416343788,"user_tz":-540,"elapsed":17,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"947172bc-fa80-4353-8ddc-9a93f9a9a8f7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["num labeled docs: 20200\n"]}]},{"cell_type":"code","source":["import torch\n","\n","def build_label_adj(num_labels, parents, children, self_loop=True, normalize=True, eps=1e-8):\n","    \"\"\"\n","    parents[c]  : 클래스 c의 부모 리스트\n","    children[c] : 클래스 c의 자식 리스트\n","    return      : [C, C] float adjacency (정규화 GCN용)\n","    \"\"\"\n","    A = torch.zeros(num_labels, num_labels, dtype=torch.float32)\n","\n","    for c in range(num_labels):\n","        # parent/child 모두 양방향 edge로\n","        for p in parents[c]:\n","            A[c, p] = 1.0\n","            A[p, c] = 1.0\n","        for ch in children[c]:\n","            A[c, ch] = 1.0\n","            A[ch, c] = 1.0\n","\n","    if self_loop:\n","        A = A + torch.eye(num_labels, dtype=torch.float32)\n","\n","    if not normalize:\n","        return A\n","\n","    # D^{-1/2} A D^{-1/2} (GCN-style)\n","    deg = A.sum(dim=1)                      # [C]\n","    deg_inv_sqrt = (deg + eps).pow(-0.5)\n","    D_inv_sqrt = torch.diag(deg_inv_sqrt)   # [C, C]\n","\n","    A_norm = D_inv_sqrt @ A @ D_inv_sqrt    # [C, C]\n","    return A_norm\n"],"metadata":{"id":"_NBkGz9xst0k"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import torch.nn as nn\n","import torch.nn.functional as F\n","\n","class LabelGCN(nn.Module):\n","    def __init__(self, in_dim, hidden_dim, out_dim, adj_norm):\n","        super().__init__()\n","        # adj_norm: [C, C] 정규화 adjacency (buffer로 등록)\n","        self.register_buffer(\"adj\", adj_norm)   # device 따라 자동 이동\n","\n","        self.lin1 = nn.Linear(in_dim, hidden_dim)\n","        self.lin2 = nn.Linear(hidden_dim, out_dim)\n","\n","    def forward(self, x):\n","        \"\"\"\n","        x : [C, in_dim] (현재 label embedding)\n","        return : [C, out_dim]\n","        \"\"\"\n","        # 1-hop message passing\n","        h = self.adj @ x                     # [C, in_dim]\n","        h = F.relu(self.lin1(h))             # [C, hidden]\n","\n","        # 2-hop\n","        h = self.adj @ h                     # [C, hidden]\n","        h = self.lin2(h)                     # [C, out_dim]\n","\n","        # residual + norm 살짝\n","        out = x + h                          # same dim 가정\n","        out = F.normalize(out, dim=1)\n","        return out\n"],"metadata":{"id":"3U6vvzVysvkY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import math\n","import numpy as np\n","import torch\n","import torch.nn as nn\n","from torch.nn.parameter import Parameter\n","from torch.nn import init\n","\n","# transformers.AutoModel 는 이제 안 써도 됨\n","# from transformers import AutoModel\n","\n","\n","class ClassModel(nn.Module):\n","    def __init__(self, enc_dim, init_class_emb: torch.Tensor,\n","                 adj_norm: torch.Tensor, gnn_hidden=256):\n","        \"\"\"\n","        enc_dim        : 문서 임베딩 차원\n","        init_class_emb : [C, d] 초기 라벨 임베딩 (mpnet/TF-IDF/GAT 등)\n","        adj_norm       : [C, C] 정규화 adjacency (GCN용)\n","        \"\"\"\n","        super().__init__()\n","\n","        self.doc_dim = enc_dim\n","        self.num_classes, self.label_dim = init_class_emb.size()\n","\n","        # 초기 라벨 임베딩을 파라미터로\n","        self.label_embedding = nn.Parameter(\n","            init_class_emb.clone().detach(), requires_grad=True\n","        )\n","\n","        # 라벨 GNN\n","        self.label_gnn = LabelGCN(\n","            in_dim=self.label_dim,\n","            hidden_dim=gnn_hidden,\n","            out_dim=self.label_dim,\n","            adj_norm=adj_norm,\n","        )\n","\n","        # bilinear interaction은 그대로\n","        self.interaction = LBM(\n","            self.doc_dim,\n","            self.label_dim,\n","            n_classes=self.num_classes,\n","            bias=False,\n","        )\n","\n","    def forward(self, doc_emb):\n","        \"\"\"\n","        doc_emb : [B, enc_dim] (SentenceTransformer 임베딩)\n","        \"\"\"\n","        # 그래프를 타고 한 번 업데이트된 라벨 임베딩\n","        label_emb = self.label_gnn(self.label_embedding)   # [C, d]\n","\n","        scores = self.interaction(doc_emb, label_emb)      # [B, C]\n","        return scores\n","\n","\n","\n","class LBM(nn.Module):\n","    def __init__(self, l_dim, r_dim, n_classes=None, bias=True):\n","        super(LBM, self).__init__()\n","        self.weight = Parameter(torch.Tensor(l_dim, r_dim))\n","        self.use_bias = bias\n","        if self.use_bias:\n","            self.bias = Parameter(torch.Tensor(n_classes))\n","\n","        bound = 1.0 / math.sqrt(l_dim)\n","        init.uniform_(self.weight, -bound, bound)\n","        if self.use_bias:\n","            init.uniform_(self.bias, -bound, bound)\n","\n","    def forward(self, e1, e2):\n","        \"\"\"\n","        e1: tensor of size (batch_size, l_dim)  -> doc emb\n","        e2: tensor of size (n_classes, r_dim)   -> label emb\n","        return: tensor of size (batch_size, n_classes)\n","        \"\"\"\n","        scores = torch.matmul(torch.matmul(e1, self.weight), e2.T)\n","        if self.use_bias:\n","            scores = scores + self.bias\n","        return scores\n"],"metadata":{"id":"MNp0b6U1ZR_K"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","# label_emb: 우리가 mpnet으로 만든 [num_class, dim] numpy array\n","#   - label 이름 + LLM 키워드 임베딩 평균으로 만든 것\n","\n","num_labels, enc_dim = label_emb.shape\n","\n","init_class_emb = torch.from_numpy(label_emb).float()\n","init_class_emb = F.normalize(init_class_emb, dim=1)   # 초기 feature만 정규화 (CPU)\n","\n","# 계층에서 parents, children 가져와서 adjacency 만들기\n","adj_norm = build_label_adj(num_labels, parents, children)  # [C, C] float CPU\n","\n","model = ClassModel(\n","    enc_dim,\n","    init_class_emb,   # CPU tensor\n","    adj_norm,         # CPU tensor\n","    gnn_hidden=256,\n",").to(device)\n","\n"],"metadata":{"id":"aXptiS-cZMSW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"QNGos_mYk1LY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import f1_score\n","import numpy as np\n","import torch\n","import torch.nn.functional as F\n","\n","def logits_to_pred_binary(logits, threshold=0.5, min_k=1, max_k=3):\n","    \"\"\"\n","    logits: [B, C] 텐서\n","    return: [B, C] numpy (0/1)\n","    \"\"\"\n","    probs = torch.sigmoid(logits).detach().cpu().numpy()\n","    B, C = probs.shape\n","    pred_bin = np.zeros_like(probs, dtype=np.int32)\n","\n","    for i in range(B):\n","        p = probs[i]\n","        pos = np.where(p >= threshold)[0].tolist()\n","\n","        # 최소 min_k개는 선택\n","        if len(pos) < min_k:\n","            order = np.argsort(-p)\n","            for k in order:\n","                if k not in pos:\n","                    pos.append(k)\n","                if len(pos) >= min_k:\n","                    break\n","\n","        # 최대 max_k개까지만\n","        if max_k is not None and len(pos) > max_k:\n","            pos = sorted(pos, key=lambda j: -p[j])[:max_k]\n","\n","        pred_bin[i, pos] = 1\n","\n","    return pred_bin\n","\n","\n","def evaluate_f1(model, dev_loader, device,\n","                threshold=0.5, min_k=1, max_k=3):\n","    \"\"\"\n","    dev_loader: TeleEmbDataset 기준\n","        각 배치가 (doc_emb, labels) 형태라고 가정\n","        - doc_emb : [B, enc_dim]\n","        - labels  : [B, C] 멀티핫\n","    \"\"\"\n","    model.eval()\n","    all_true = []\n","    all_pred = []\n","\n","    with torch.no_grad():\n","        for doc_emb_b, labels_b_t,_ in dev_loader:\n","            # doc_emb_b: [B, enc_dim] (CPU -> GPU)\n","            doc_emb_b = doc_emb_b.to(device)\n","            # labels_b: numpy [B, C]\n","            labels_b  = labels_b_t.cpu().numpy()\n","\n","            # 모델은 이제 임베딩만 받음\n","            logits = model(doc_emb_b)  # [B, C]\n","\n","            pred_b = logits_to_pred_binary(\n","                logits,\n","                threshold=threshold,\n","                min_k=min_k,\n","                max_k=max_k,\n","            )\n","\n","            all_true.append(labels_b)\n","            all_pred.append(pred_b)\n","\n","    y_true = np.concatenate(all_true, axis=0)\n","    y_pred = np.concatenate(all_pred, axis=0)\n","\n","    micro = f1_score(y_true, y_pred, average=\"micro\", zero_division=0)\n","    macro = f1_score(y_true, y_pred, average=\"macro\", zero_division=0)\n","    return micro, macro\n"],"metadata":{"id":"GN5a2fHsaGXT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import random\n","\n","# refined_labels_multi: List[List[int]]\n","# all_docs, all_docs_id: 전체 corpus / id 리스트\n","num_labels = label_emb.shape[0]\n","\n","# 1) 라벨이 하나라도 있는 문서만 사용\n","labeled_idx = [i for i, labs in enumerate(core_labels_multi) if len(labs) > 0]\n","print(\"num labeled docs:\", len(labeled_idx))\n","\n","# 2) train / val split (예: 90 / 10)\n","random.seed(42)\n","random.shuffle(labeled_idx)\n","\n","split = int(len(labeled_idx) * 0.9)\n","train_idx = labeled_idx[:split]\n","val_idx   = labeled_idx[split:]\n","\n","print(\"train docs:\", len(train_idx), \"  val docs:\", len(val_idx))\n","\n","train_texts  = [all_docs[i] for i in train_idx]\n","train_labels = [core_labels_multi[i] for i in train_idx]\n","\n","val_texts    = [all_docs[i] for i in val_idx]\n","val_labels   = [core_labels_multi[i] for i in val_idx]\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mn9-UOYeaIoH","executionInfo":{"status":"ok","timestamp":1764416452286,"user_tz":-540,"elapsed":64,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"83f6b101-30b7-4868-e59a-375210b8eade"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["num labeled docs: 20200\n","train docs: 18180   val docs: 2020\n"]}]},{"cell_type":"code","source":["import torch\n","import torch.nn.functional as F\n","\n","def build_pos_neg_masks_from_core(core_label_lists, num_labels, parents, children, device):\n","    \"\"\"\n","    core_label_lists : List[List[int]] (배치 안 각 문서의 core 라벨 인덱스 리스트)\n","    return:\n","        pos_mask : [B, C] float (pos 위치 1.0)\n","        neg_mask : [B, C] float (neg 위치 1.0)\n","    \"\"\"\n","    B = len(core_label_lists)\n","    pos_mask = torch.zeros(B, num_labels, dtype=torch.float32, device=device)\n","    neg_mask = torch.zeros(B, num_labels, dtype=torch.float32, device=device)\n","\n","    all_classes = set(range(num_labels))\n","\n","    for i, labs in enumerate(core_label_lists):\n","        if not labs:\n","            continue  # core 라벨이 전혀 없는 문서는 그냥 skip (이 배치에는 거의 없겠지만)\n","\n","        ci = set(labs)\n","\n","        # C_i^pos = parents ∪ Ci\n","        pos_set = set(ci)\n","        for c in ci:\n","            pos_set.update(parents[c])\n","\n","        # children union\n","        chd_union = set()\n","        for c in ci:\n","            chd_union.update(children[c])\n","\n","        # C_i^neg = C - C_i^pos - children union\n","        neg_set = all_classes - pos_set - chd_union\n","\n","        pos_idx = list(pos_set)\n","        neg_idx = list(neg_set)\n","\n","        pos_mask[i, pos_idx] = 1.0\n","        neg_mask[i, neg_idx] = 1.0\n","\n","    return pos_mask, neg_mask\n"],"metadata":{"id":"EL1AKRC7lIZ6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def hierarchical_bce_loss(logits, core_label_lists, num_labels, parents, children):\n","    \"\"\"\n","    logits           : [B, C] (ClassModel 출력)\n","    core_label_lists : List[List[int]] (현재 배치의 각 문서 core 라벨 인덱스)\n","    \"\"\"\n","    device = logits.device\n","    pos_mask, neg_mask = build_pos_neg_masks_from_core(\n","        core_label_lists, num_labels, parents, children, device\n","    )\n","\n","    log_p      = F.logsigmoid(logits)   # log p_ij\n","    log_1_minus_p = F.logsigmoid(-logits)  # log(1 - p_ij)\n","\n","    loss_pos = -(pos_mask * log_p).sum()\n","    loss_neg = -(neg_mask * log_1_minus_p).sum()\n","\n","    denom = pos_mask.sum() + neg_mask.sum() + 1e-8\n","    loss = (loss_pos + loss_neg) / denom\n","    return loss\n"],"metadata":{"id":"OAKBEmq4lJCt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import torch\n","\n","def pseudo_kl_loss(student_logits, teacher_probs, eps=1e-8):\n","    \"\"\"\n","    student_logits : [B_pseudo, C]  (현재 모델 logits)\n","    teacher_probs  : [B_pseudo, C]  (pseudo 만들 당시의 확률 Q, detach 상태)\n","    \"\"\"\n","    p = torch.sigmoid(student_logits)\n","    p = p.clamp(min=eps, max=1-eps)\n","\n","    q = teacher_probs.clamp(min=eps, max=1-eps)\n","\n","    # KL(Q || P) for Bernoulli\n","    loss = q * torch.log(q / p) + (1 - q) * torch.log((1 - q) / (1 - p))\n","    return loss.mean()   # 샘플/라벨 평균\n"],"metadata":{"id":"VX6pSFARnufU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from torch.utils.data import Dataset\n","import torch\n","\n","class UnlabeledEmbDataset(Dataset):\n","    def __init__(self, emb_tensor):\n","        \"\"\"\n","        emb_tensor : [N_unlab, enc_dim]  (SentenceTransformer 등으로 미리 뽑은 임베딩)\n","        \"\"\"\n","        self.emb_tensor = emb_tensor\n","\n","    def __len__(self):\n","        return self.emb_tensor.shape[0]  # 또는 len(self.emb_tensor)\n","\n","\n","    def __getitem__(self, idx):\n","        # doc_emb: [enc_dim], idx: 원본 인덱스 (pseudo 중복 방지용)\n","        return self.emb_tensor[idx], idx\n"],"metadata":{"id":"vCBKsJr6auFj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from torch.utils.data import Dataset, DataLoader\n","from transformers import AutoTokenizer\n","import torch.nn.functional as F\n","\n","\n","from sentence_transformers import SentenceTransformer\n","import torch\n","\n","ENCODER_NAME = \"sentence-transformers/all-mpnet-base-v2\"\n","st_model = SentenceTransformer(ENCODER_NAME).to(device)\n","\n","with torch.no_grad():\n","    train_emb = st_model.encode(\n","        train_texts,\n","        batch_size=128,\n","        convert_to_tensor=True,\n","        show_progress_bar=True,\n","    ).cpu()  # [N_train, enc_dim]\n","\n","    val_emb = st_model.encode(\n","        val_texts,\n","        batch_size=128,\n","        convert_to_tensor=True,\n","        show_progress_bar=True,\n","    ).cpu()  # [N_val, enc_dim]\n","\n","\n","class TeleEmbDataset(Dataset):\n","    def __init__(self, emb_tensor, label_lists, num_labels):\n","        self.emb_tensor = emb_tensor      # [N, enc_dim], CPU tensor\n","        self.label_lists = label_lists    # List[List[int]]\n","        self.num_labels  = num_labels\n","\n","    def __len__(self):\n","        return self.emb_tensor.size(0)\n","\n","    def __getitem__(self, idx):\n","        x    = self.emb_tensor[idx]       # [enc_dim]\n","        labs = self.label_lists[idx]\n","\n","        y = torch.zeros(self.num_labels, dtype=torch.float32)\n","        for c in labs:\n","            if 0 <= c < self.num_labels:\n","                y[c] = 1.0\n","\n","        # (x, y, global_index) 형태로 반환\n","        return x, y, idx\n","\n","\n","\n","train_dataset = TeleEmbDataset(train_emb, train_labels, num_labels)\n","val_dataset   = TeleEmbDataset(val_emb,   val_labels,   num_labels)\n","\n","train_loader = DataLoader(train_dataset, batch_size=16, shuffle=True, num_workers=4)\n","val_loader   = DataLoader(val_dataset,   batch_size=32, shuffle=False, num_workers=4)\n"],"metadata":{"id":"nbnOq4nRaMGg","colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["5c9ade92161c4fde9dac99a0e1e6e702","8018edcfe6154a4dbbfac09f76f986c9","e8f57431fe0f47f2b9464f55f8f33a66","de56c96d8b814db982b7dd0626863b8f","77ed78b43fef41af8ac780df78491042","3580f6972616471aa2a216c497ed1558","17df1942ff914667951a9026ab667a1d","30adac7befe847c8bb23a5f2b46dce31","184259816cca46c59f69dad34e70ad46","6bf7cd082cd140dd8b79d9c963225399","7ab71a74fd5644288272410d6716e874","3a16008ab4ae4e229558c7fcb24925e1","9327a6b5eaa342a6944c3f3f8974741e","69cc405f67b548459cd10182023cbc06","0151f8bacbc24fdb8d14a8b3ed1fea61","ae9ee1d69919495aae7cc23b00690b70","6406edd61cd949708f45333587e0ce5a","923fe8d2ac934d3594de86dc304ad7e6","9fbd388cc40640b5af67edd7a12854f4","f20f6a5fc18f42c8918ddbea04744168","12cbbe5390f94f20aef2296585b230ca","51e6986fb3c6413ab35cd839659cb033"]},"executionInfo":{"status":"ok","timestamp":1764425020323,"user_tz":-540,"elapsed":78088,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"7d04de37-8a23-48ba-fe00-b3b5de2e33c7"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/143 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5c9ade92161c4fde9dac99a0e1e6e702"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/16 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3a16008ab4ae4e229558c7fcb24925e1"}},"metadata":{}}]},{"cell_type":"code","source":["# initial core 기준으로 라벨이 하나도 없는 문서들\n","unlabeled_idx = [i for i, labs in enumerate(core_labels_multi) if len(labs) == 0]\n","print(\"num unlabeled docs:\", len(unlabeled_idx))\n","\n","unlab_texts = [all_docs[i] for i in unlabeled_idx]\n","\n","with torch.no_grad():\n","    unlab_emb = st_model.encode(\n","        unlab_texts,\n","        batch_size=128,          # 여유 있으면 256으로 올려도 됨\n","        convert_to_tensor=True,  # 바로 torch.Tensor로\n","        show_progress_bar=True,\n","    ).cpu()  # shape: [N_unlab, enc_dim]\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":67,"referenced_widgets":["ac52f0e5152d4547934cb4065fc04295","f644fedcccaa4a41b0340d00fcaee211","ac726aca75cd413ca34fd2d1767b0bc0","c71a43bbf0e542bca319d6e623701d6a","2657aef281e54c14bdca4c61262b9c19","600e560ad2344f21a7f40c2dd62eae54","9200830ed9a94df69dd72b4b569d7f61","57ba8f02c7f84733b1f646a2cd11bf41","295dabe38401413287c8168101622242","54b7f38b6f244a19b29d58e473b44136","4015c2219e4e4a6fbddeaddf71c6e8e6"]},"id":"RJThKwWIclWF","executionInfo":{"status":"ok","timestamp":1764425059627,"user_tz":-540,"elapsed":39232,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"be240b83-77c4-4fda-d446-bf29edce8c2b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["num unlabeled docs: 9287\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/73 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ac52f0e5152d4547934cb4065fc04295"}},"metadata":{}}]},{"cell_type":"code","source":["from torch.utils.data import DataLoader\n","\n","# labeled / dev / unlabeled Dataset\n","train_dataset = TeleEmbDataset(train_emb, train_labels, num_labels)\n","val_dataset   = TeleEmbDataset(val_emb,   val_labels,   num_labels)\n","unlab_dataset = UnlabeledEmbDataset(unlab_emb)\n","\n","train_loader = DataLoader(train_dataset, batch_size=16, shuffle=True,  num_workers=0)\n","val_loader   = DataLoader(val_dataset,   batch_size=32, shuffle=False, num_workers=0)\n","unlab_loader = DataLoader(unlab_dataset, batch_size=64, shuffle=False, num_workers=0)\n"],"metadata":{"id":"KSrYaKxecWJT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","# ----- mpnet 기반 class_emb 셋업 -----\n","num_labels, enc_dim = label_emb.shape\n","class_emb = torch.from_numpy(label_emb).float()   # [C, d]\n","class_emb = F.normalize(class_emb, dim=1)        # 선택사항이지만 보통 좋음\n","class_emb = class_emb.to(device)\n","\n","\n","\n","# ----- 옵티마 / loss -----\n","EPOCHS           = 60                 # 5 epoch 이후부터 pseudo 넣을 거니까 20 정도로\n","PSEUDO_START_EP  = 5                  # 5 epoch 이후부터 pseudo 시작\n","PSEUDO_THRESH    = 0.45               # pseudo label threshold\n","lr               = 1e-3\n","weight_decay     = 1e-4\n","\n","optimizer = torch.optim.AdamW(model.parameters(), lr=lr, weight_decay=weight_decay)\n","criterion = nn.BCEWithLogitsLoss()\n","\n","best_macro = -1.0\n","best_state = None\n","\n","# unlabeled 샘플 중 이미 pseudo로 쓴 것 체크용\n","used_unlab = torch.zeros(len(unlab_dataset), dtype=torch.bool)\n"],"metadata":{"id":"jUqmfPlaca4n"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# initial train_emb, train_labels를 다 만든 직후\n","train_teacher_q = [None] * len(train_labels)\n"],"metadata":{"id":"MFD503Tc7fKW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["lambda_kl = 0.05   # 처음엔 아주 작게 시작\n","\n","for epoch in range(1, EPOCHS + 1):\n","    model.train()\n","    total_loss = 0.0\n","\n","    for doc_emb, y, idx_batch in train_loader:\n","        doc_emb = doc_emb.to(device)\n","        y       = y.to(device)\n","        idx_batch = idx_batch.numpy()   # global index들\n","\n","        logits = model(doc_emb)   # [B, C]\n","\n","        # 1) supervised 계층 BCE\n","        core_label_lists = []\n","        y_cpu = y.cpu().numpy()\n","        for i in range(y.shape[0]):\n","            labs = np.where(y_cpu[i] > 0.5)[0].tolist()\n","            core_label_lists.append(labs)\n","\n","        loss_sup = hierarchical_bce_loss(\n","            logits,\n","            core_label_lists,\n","            num_labels,\n","            parents,\n","            children,\n","        )\n","\n","        # 2) pseudo에만 KL 추가\n","        # pseudo로 올라간 샘플만 골라내기\n","        pseudo_indices = []\n","        teacher_q_list = []\n","\n","        for b_pos, global_idx in enumerate(idx_batch):\n","            q = train_teacher_q[global_idx]   # None or [C] tensor (CPU)\n","            if q is not None:\n","                pseudo_indices.append(b_pos)\n","                teacher_q_list.append(q)\n","\n","        if len(pseudo_indices) > 0:\n","            pseudo_indices = torch.tensor(pseudo_indices, dtype=torch.long, device=device)\n","            logits_pseudo  = logits[pseudo_indices]          # [B_pseudo, C]\n","\n","            teacher_q_tensor = torch.stack(teacher_q_list, dim=0).to(device)  # [B_pseudo, C]\n","\n","            loss_kl = pseudo_kl_loss(logits_pseudo, teacher_q_tensor)\n","            loss = loss_sup + lambda_kl * loss_kl\n","        else:\n","            loss_kl = torch.tensor(0.0, device=device)\n","            loss = loss_sup\n","\n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()\n","\n","        total_loss += loss_sup.item()  # or loss.item() 둘 다 찍어봐도 좋음\n","\n","\n","    avg_loss = total_loss / len(train_loader)\n","\n","    # ===== 2) dev F1 =====\n","    micro_f1, macro_f1 = evaluate_f1(model, val_loader, device)\n","\n","    print(f\"[Epoch {epoch}/{EPOCHS}] \"\n","          f\"train_loss={avg_loss:.4f}  \"\n","          f\"dev_micro={micro_f1:.4f}  dev_macro={macro_f1:.4f}\")\n","    # best 모델 저장 (macro 기준 예시)\n","    if macro_f1 > best_macro:\n","        best_macro = macro_f1\n","        best_state = {k: v.cpu() for k, v in model.state_dict().items()}\n","        print(\"  -> new best macro F1, saving state\")\n","\n","    # ===== 3) pseudo labeling (5 epoch 이후부터) =====\n","    if epoch >= PSEUDO_START_EP:\n","        model.eval()\n","        new_emb_list       = []\n","        new_label_list     = []\n","        new_teacher_q_list = []      # ★ 추가\n","\n","        with torch.no_grad():\n","            for doc_emb, idxs in unlab_loader:\n","                doc_emb = doc_emb.to(device)\n","                logits  = model(doc_emb)\n","                probs   = torch.sigmoid(logits).cpu()  # [B, C]\n","                idxs    = idxs.cpu()\n","\n","                for i in range(probs.size(0)):\n","                    idx = int(idxs[i].item())\n","                    if used_unlab[idx]:\n","                        continue\n","\n","                    p_vec = probs[i]  # [C] ← 이게 teacher 확률 Q 후보\n","\n","                    # threshold로 pseudo 라벨 선택\n","                    label_ids = (p_vec >= PSEUDO_THRESH).nonzero(as_tuple=False).view(-1).tolist()\n","                    if len(label_ids) == 0:\n","                        continue\n","\n","                    used_unlab[idx] = True\n","\n","                    new_emb_list.append(doc_emb[i].detach().cpu())\n","                    new_label_list.append(label_ids)\n","                    new_teacher_q_list.append(p_vec.clone())   # ★ teacher Q 저장\n","\n","\n","        print(f\"  pseudo: added {len(new_emb_list)} new samples at epoch {epoch}\")\n","\n","        # ===== 4) 새 pseudo 샘플을 train set에 합치고 DataLoader 업데이트 =====\n","        if len(new_emb_list) > 0:\n","            new_emb_tensor = torch.stack(new_emb_list, dim=0)   # [N_new, enc_dim]\n","            train_emb      = torch.cat([train_emb, new_emb_tensor], dim=0)\n","\n","            train_labels.extend(new_label_list)\n","            train_teacher_q.extend(new_teacher_q_list)          # ★ 여기서 같이 extend\n","\n","            train_dataset = TeleEmbDataset(train_emb, train_labels, num_labels)\n","            train_loader  = DataLoader(train_dataset, batch_size=16, shuffle=True, num_workers=4)\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IhDNloMWYrMK","executionInfo":{"status":"ok","timestamp":1764426179776,"user_tz":-540,"elapsed":858019,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"724eeb39-1da6-491c-db0a-29c7ca2de307"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[Epoch 1/60] train_loss=0.0164  dev_micro=0.2848  dev_macro=0.0388\n","  -> new best macro F1, saving state\n","[Epoch 2/60] train_loss=0.0133  dev_micro=0.3646  dev_macro=0.0710\n","  -> new best macro F1, saving state\n","[Epoch 3/60] train_loss=0.0115  dev_micro=0.4178  dev_macro=0.0993\n","  -> new best macro F1, saving state\n","[Epoch 4/60] train_loss=0.0104  dev_micro=0.4485  dev_macro=0.1281\n","  -> new best macro F1, saving state\n","[Epoch 5/60] train_loss=0.0095  dev_micro=0.4671  dev_macro=0.1396\n","  -> new best macro F1, saving state\n","  pseudo: added 6143 new samples at epoch 5\n","[Epoch 6/60] train_loss=0.0198  dev_micro=0.4264  dev_macro=0.1118\n","  pseudo: added 254 new samples at epoch 6\n","[Epoch 7/60] train_loss=0.0187  dev_micro=0.4417  dev_macro=0.1153\n","  pseudo: added 56 new samples at epoch 7\n","[Epoch 8/60] train_loss=0.0183  dev_micro=0.4377  dev_macro=0.1320\n","  pseudo: added 201 new samples at epoch 8\n","[Epoch 9/60] train_loss=0.0180  dev_micro=0.4466  dev_macro=0.1345\n","  pseudo: added 35 new samples at epoch 9\n","[Epoch 10/60] train_loss=0.0177  dev_micro=0.4614  dev_macro=0.1403\n","  -> new best macro F1, saving state\n","  pseudo: added 21 new samples at epoch 10\n","[Epoch 11/60] train_loss=0.0174  dev_micro=0.4684  dev_macro=0.1510\n","  -> new best macro F1, saving state\n","  pseudo: added 111 new samples at epoch 11\n","[Epoch 12/60] train_loss=0.0173  dev_micro=0.4879  dev_macro=0.1551\n","  -> new best macro F1, saving state\n","  pseudo: added 49 new samples at epoch 12\n","[Epoch 13/60] train_loss=0.0171  dev_micro=0.4771  dev_macro=0.1557\n","  -> new best macro F1, saving state\n","  pseudo: added 14 new samples at epoch 13\n","[Epoch 14/60] train_loss=0.0170  dev_micro=0.4745  dev_macro=0.1531\n","  pseudo: added 18 new samples at epoch 14\n","[Epoch 15/60] train_loss=0.0168  dev_micro=0.4779  dev_macro=0.1589\n","  -> new best macro F1, saving state\n","  pseudo: added 21 new samples at epoch 15\n","[Epoch 16/60] train_loss=0.0166  dev_micro=0.4917  dev_macro=0.1765\n","  -> new best macro F1, saving state\n","  pseudo: added 45 new samples at epoch 16\n","[Epoch 17/60] train_loss=0.0165  dev_micro=0.4878  dev_macro=0.1703\n","  pseudo: added 28 new samples at epoch 17\n","[Epoch 18/60] train_loss=0.0165  dev_micro=0.4796  dev_macro=0.1663\n","  pseudo: added 10 new samples at epoch 18\n","[Epoch 19/60] train_loss=0.0163  dev_micro=0.4874  dev_macro=0.1728\n","  pseudo: added 4 new samples at epoch 19\n","[Epoch 20/60] train_loss=0.0163  dev_micro=0.4937  dev_macro=0.1772\n","  -> new best macro F1, saving state\n","  pseudo: added 17 new samples at epoch 20\n","[Epoch 21/60] train_loss=0.0162  dev_micro=0.4908  dev_macro=0.1738\n","  pseudo: added 33 new samples at epoch 21\n","[Epoch 22/60] train_loss=0.0161  dev_micro=0.4995  dev_macro=0.1850\n","  -> new best macro F1, saving state\n","  pseudo: added 49 new samples at epoch 22\n","[Epoch 23/60] train_loss=0.0160  dev_micro=0.5115  dev_macro=0.2009\n","  -> new best macro F1, saving state\n","  pseudo: added 41 new samples at epoch 23\n","[Epoch 24/60] train_loss=0.0159  dev_micro=0.5064  dev_macro=0.1870\n","  pseudo: added 46 new samples at epoch 24\n","[Epoch 25/60] train_loss=0.0159  dev_micro=0.5105  dev_macro=0.1883\n","  pseudo: added 20 new samples at epoch 25\n","[Epoch 26/60] train_loss=0.0159  dev_micro=0.5092  dev_macro=0.1920\n","  pseudo: added 5 new samples at epoch 26\n","[Epoch 27/60] train_loss=0.0158  dev_micro=0.5076  dev_macro=0.1894\n","  pseudo: added 9 new samples at epoch 27\n","[Epoch 28/60] train_loss=0.0157  dev_micro=0.4973  dev_macro=0.1869\n","  pseudo: added 7 new samples at epoch 28\n","[Epoch 29/60] train_loss=0.0157  dev_micro=0.5091  dev_macro=0.1921\n","  pseudo: added 12 new samples at epoch 29\n","[Epoch 30/60] train_loss=0.0156  dev_micro=0.5140  dev_macro=0.1992\n","  pseudo: added 10 new samples at epoch 30\n","[Epoch 31/60] train_loss=0.0156  dev_micro=0.5127  dev_macro=0.2011\n","  -> new best macro F1, saving state\n","  pseudo: added 5 new samples at epoch 31\n","[Epoch 32/60] train_loss=0.0155  dev_micro=0.5132  dev_macro=0.1980\n","  pseudo: added 7 new samples at epoch 32\n","[Epoch 33/60] train_loss=0.0155  dev_micro=0.5098  dev_macro=0.1922\n","  pseudo: added 5 new samples at epoch 33\n","[Epoch 34/60] train_loss=0.0154  dev_micro=0.5155  dev_macro=0.2022\n","  -> new best macro F1, saving state\n","  pseudo: added 9 new samples at epoch 34\n","[Epoch 35/60] train_loss=0.0154  dev_micro=0.5348  dev_macro=0.2197\n","  -> new best macro F1, saving state\n","  pseudo: added 42 new samples at epoch 35\n","[Epoch 36/60] train_loss=0.0154  dev_micro=0.5107  dev_macro=0.1993\n","  pseudo: added 10 new samples at epoch 36\n","[Epoch 37/60] train_loss=0.0153  dev_micro=0.5225  dev_macro=0.2048\n","  pseudo: added 22 new samples at epoch 37\n","[Epoch 38/60] train_loss=0.0153  dev_micro=0.5174  dev_macro=0.2048\n","  pseudo: added 4 new samples at epoch 38\n","[Epoch 39/60] train_loss=0.0153  dev_micro=0.5126  dev_macro=0.1984\n","  pseudo: added 6 new samples at epoch 39\n","[Epoch 40/60] train_loss=0.0152  dev_micro=0.5196  dev_macro=0.2039\n","  pseudo: added 5 new samples at epoch 40\n","[Epoch 41/60] train_loss=0.0151  dev_micro=0.5251  dev_macro=0.2176\n","  pseudo: added 29 new samples at epoch 41\n","[Epoch 42/60] train_loss=0.0151  dev_micro=0.5117  dev_macro=0.1997\n","  pseudo: added 2 new samples at epoch 42\n","[Epoch 43/60] train_loss=0.0150  dev_micro=0.5176  dev_macro=0.2090\n","  pseudo: added 1 new samples at epoch 43\n","[Epoch 44/60] train_loss=0.0151  dev_micro=0.5226  dev_macro=0.2082\n","  pseudo: added 3 new samples at epoch 44\n","[Epoch 45/60] train_loss=0.0150  dev_micro=0.5157  dev_macro=0.2082\n","  pseudo: added 5 new samples at epoch 45\n","[Epoch 46/60] train_loss=0.0150  dev_micro=0.5215  dev_macro=0.2130\n","  pseudo: added 6 new samples at epoch 46\n","[Epoch 47/60] train_loss=0.0150  dev_micro=0.5210  dev_macro=0.2090\n","  pseudo: added 2 new samples at epoch 47\n","[Epoch 48/60] train_loss=0.0149  dev_micro=0.5289  dev_macro=0.2136\n","  pseudo: added 8 new samples at epoch 48\n","[Epoch 49/60] train_loss=0.0149  dev_micro=0.5226  dev_macro=0.2121\n","  pseudo: added 5 new samples at epoch 49\n"]},{"output_type":"stream","name":"stderr","text":["Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7d3bfbf29ee0>\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.12/dist-packages/torch/utils/data/dataloader.py\", line 1654, in __del__\n","    self._shutdown_workers()\n","  File \"/usr/local/lib/python3.12/dist-packages/torch/utils/data/dataloader.py\", line 1637, in _shutdown_workers\n","    if w.is_alive():\n","       ^^^^^^^^^^^^\n","  File \"/usr/lib/python3.12/multiprocessing/process.py\", line 160, in is_alive\n","    assert self._parent_pid == os.getpid(), 'can only test a child process'\n","           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","AssertionError: can only test a child process\n"]},{"output_type":"stream","name":"stdout","text":["[Epoch 50/60] train_loss=0.0148  dev_micro=0.5267  dev_macro=0.2120\n","  pseudo: added 23 new samples at epoch 50\n","[Epoch 51/60] train_loss=0.0148  dev_micro=0.5222  dev_macro=0.2197\n","  pseudo: added 5 new samples at epoch 51\n","[Epoch 52/60] train_loss=0.0148  dev_micro=0.5275  dev_macro=0.2217\n","  -> new best macro F1, saving state\n","  pseudo: added 25 new samples at epoch 52\n","[Epoch 53/60] train_loss=0.0148  dev_micro=0.5302  dev_macro=0.2228\n","  -> new best macro F1, saving state\n","  pseudo: added 13 new samples at epoch 53\n","[Epoch 54/60] train_loss=0.0148  dev_micro=0.5213  dev_macro=0.2119\n","  pseudo: added 6 new samples at epoch 54\n","[Epoch 55/60] train_loss=0.0147  dev_micro=0.5409  dev_macro=0.2307\n","  -> new best macro F1, saving state\n","  pseudo: added 26 new samples at epoch 55\n","[Epoch 56/60] train_loss=0.0147  dev_micro=0.5227  dev_macro=0.2175\n","  pseudo: added 4 new samples at epoch 56\n","[Epoch 57/60] train_loss=0.0147  dev_micro=0.5178  dev_macro=0.2137\n","  pseudo: added 4 new samples at epoch 57\n","[Epoch 58/60] train_loss=0.0147  dev_micro=0.5150  dev_macro=0.2094\n","  pseudo: added 0 new samples at epoch 58\n","[Epoch 59/60] train_loss=0.0146  dev_micro=0.5232  dev_macro=0.2087\n","  pseudo: added 0 new samples at epoch 59\n","[Epoch 60/60] train_loss=0.0146  dev_micro=0.5313  dev_macro=0.2132\n","  pseudo: added 1 new samples at epoch 60\n"]}]},{"cell_type":"code","source":["import os\n","\n","if best_state is not None:\n","    save_path = os.path.join(DATA_DIR, \"classmodel_initial_pseudo_best_gnn_kl.pt\")\n","    torch.save(best_state, save_path)\n","    print(\"saved best model to:\", save_path)\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"j8OmKXdrcijz","executionInfo":{"status":"ok","timestamp":1764426259518,"user_tz":-540,"elapsed":46,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"160fec2a-9848-4508-a9f4-b30fd08f8863"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["saved best model to: /content/drive/MyDrive/BDA/Amazon_products/classmodel_initial_pseudo_best_gnn_kl.pt\n"]}]},{"cell_type":"code","source":["model.load_state_dict(torch.load(save_path, weights_only=True))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sHPchkLViaZ0","executionInfo":{"status":"ok","timestamp":1764426260739,"user_tz":-540,"elapsed":47,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"396a9558-51be-456c-ac73-0a0306a567a2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{},"execution_count":122}]},{"cell_type":"code","source":["import os\n","import csv\n","import numpy as np\n","import torch\n","from torch.utils.data import DataLoader\n","from tqdm.auto import tqdm\n","\n","test_corpus_path = os.path.join(DATA_DIR, \"test\", \"test_corpus.txt\")\n","\n","test_doc_ids = []\n","test_texts = []\n","\n","with open(test_corpus_path, \"r\", encoding=\"utf-8\") as f:\n","    for line in f:\n","        line = line.rstrip(\"\\n\")\n","        if not line:\n","            continue\n","        doc_id, text = line.split(\"\\t\", 1)\n","        test_doc_ids.append(doc_id)\n","        test_texts.append(text)\n","\n","print(f\"# test docs: {len(test_doc_ids)}\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DpzqdrRpblY5","executionInfo":{"status":"ok","timestamp":1764419744940,"user_tz":-540,"elapsed":58,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"352be5fb-be9b-4dca-ecaa-ca62c99135a9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["# test docs: 19658\n"]}]},{"cell_type":"code","source":["from sentence_transformers import SentenceTransformer\n","\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","ENCODER_NAME = \"sentence-transformers/all-mpnet-base-v2\"\n","st_model = SentenceTransformer(ENCODER_NAME, device=str(device))\n","\n","with torch.no_grad():\n","    test_emb = st_model.encode(\n","        test_texts,\n","        batch_size=128,\n","        convert_to_tensor=True,\n","        show_progress_bar=True,\n","    ).cpu()   # ★ CPU로 내려놓기 (DataLoader worker 문제 피하려고)\n","\n","print(\"test_emb shape:\", test_emb.shape)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":67,"referenced_widgets":["d90d6bffe74f453faa650acacc9b334c","4295478e833c47d6ba6abaad1ed126fb","e5f7124aa2784825a58f875bf022b056","b966a2665c99400cb4d4b0b1cad4c581","5d103d501bc844a48b88a139ecf0708a","c078b21f1fcb456995901f24cc6a0b9b","7d11a3df7f67497dbd21164dd0a157f2","dceb9af0c06c47e896f1744f38d86ede","9e043d67ecf049ef97695f1641d53bb2","0a0a5b1d0aa34602b5fa941df4516d8b","1579ff8e44b64d7485ffbcfbc9216483"]},"id":"jo6YbQ20iHEN","executionInfo":{"status":"ok","timestamp":1764418602352,"user_tz":-540,"elapsed":79117,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"5968be5f-3f8c-4e22-9c5c-c52122311b54"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/154 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d90d6bffe74f453faa650acacc9b334c"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["test_emb shape: torch.Size([19658, 768])\n"]}]},{"cell_type":"code","source":["from torch.utils.data import Dataset\n","\n","class TestEmbDataset(Dataset):\n","    def __init__(self, emb_tensor):\n","        # 혹시 리스트/넘파이여도 텐서로\n","        if not isinstance(emb_tensor, torch.Tensor):\n","            emb_tensor = torch.as_tensor(emb_tensor)\n","        # GPU로 들어왔으면 CPU로\n","        if emb_tensor.is_cuda:\n","            emb_tensor = emb_tensor.cpu()\n","\n","        self.emb_tensor = emb_tensor  # [N_test, enc_dim]\n","\n","    def __len__(self):\n","        return self.emb_tensor.shape[0]\n","\n","    def __getitem__(self, idx):\n","        return self.emb_tensor[idx]   # [enc_dim]\n","\n","\n","test_dataset = TestEmbDataset(test_emb)\n","test_loader  = DataLoader(\n","    test_dataset,\n","    batch_size=64,\n","    shuffle=False,\n","    num_workers=4,   # 에러 나면 0으로 줄이기\n",")\n"],"metadata":{"id":"OThm0mf0iOkL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["TOP_K_MIN = 2\n","TOP_K_MAX = 3\n","\n","model.eval()\n","predictions = {}\n","\n","BATCH_SIZE = 64\n","N = test_emb.shape[0]\n","\n","with torch.no_grad():\n","    for start in range(0, N, BATCH_SIZE):\n","        end = min(start + BATCH_SIZE, N)\n","        doc_emb_b = test_emb[start:end].to(device)   # [B, enc_dim]\n","\n","        logits = model(doc_emb_b)  # [B, C]\n","\n","        pred_bin = logits_to_pred_binary(\n","            logits,\n","            threshold=0.5,\n","            min_k=TOP_K_MIN,\n","            max_k=TOP_K_MAX,\n","        )                          # [B, C] 0/1\n","        pred_bin = pred_bin.astype(bool)\n","\n","        for i in range(end - start):\n","            row_idx = start + i\n","            doc_id = test_doc_ids[row_idx]\n","            pos = np.where(pred_bin[i])[0]           # 선택된 label index들\n","            label_ids = [str(k) for k in pos]\n","            predictions[doc_id] = label_ids\n"],"metadata":{"id":"2OcNe1jRbnIM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["submit_path = os.path.join(DATA_DIR, \"submission_s_test_gnn_kl.csv\")\n","with open(submit_path, \"w\", newline=\"\", encoding=\"utf-8\") as f:\n","    writer = csv.writer(f)\n","    writer.writerow([\"id\", \"label\"])  # 포맷 맞게 조정\n","\n","    for doc_id in test_doc_ids:\n","        label_ids = predictions[doc_id]  # [\"3\", \"40\", \"169\"] 같은 리스트\n","        label_str = \",\".join(label_ids)\n","        writer.writerow([doc_id, label_str])\n","\n","print(\"saved submission to:\", submit_path)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KDlRCEtvbtoG","executionInfo":{"status":"ok","timestamp":1764426275204,"user_tz":-540,"elapsed":27,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"a378f16d-0123-4287-be1c-c30c0b81b020"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["saved submission to: /content/drive/MyDrive/BDA/Amazon_products/submission_s_test_gnn_kl.csv\n"]}]},{"cell_type":"code","source":["from collections import Counter\n","\n","label_cnt = Counter()\n","for lbls in predictions.values():  # doc_id -> [label1, label2, ...]\n","    label_cnt.update(lbls)\n","\n","print(\"Top 20 labels in predictions:\")\n","for lid, c in label_cnt.most_common(20):\n","    print(lid, \":\", c)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"U4133fW1bvwK","executionInfo":{"status":"ok","timestamp":1764426285286,"user_tz":-540,"elapsed":21,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"083c36dc-4e00-44df-805c-c30b328a877a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Top 20 labels in predictions:\n","3 : 3461\n","10 : 2257\n","34 : 1852\n","199 : 1304\n","11 : 1168\n","170 : 955\n","220 : 946\n","64 : 933\n","40 : 921\n","131 : 836\n","24 : 819\n","74 : 813\n","265 : 733\n","60 : 719\n","208 : 713\n","4 : 708\n","26 : 669\n","44 : 621\n","0 : 603\n","23 : 595\n"]}]},{"cell_type":"code","source":["import pandas as pd\n","from collections import Counter\n","import numpy as np\n","import re\n","\n","df = pd.read_csv(submit_path)\n","\n","print(\"=== 기본 정보 ===\")\n","print(\"행 개수 (docs):\", len(df))\n","print(\"컬럼:\", list(df.columns))\n","\n","# 1) 라벨 컬럼 이름 자동 선택 (label 또는 labels)\n","if \"label\" in df.columns:\n","    label_col = \"label\"\n","elif \"labels\" in df.columns:\n","    label_col = \"labels\"\n","else:\n","    raise ValueError(\"라벨 컬럼명을 찾을 수 없습니다. 'label' 또는 'labels'가 필요합니다.\")\n","\n","label_strs = df[label_col].fillna(\"\").astype(str)\n","\n","all_labels_flat  = []        # 개별 숫자 라벨\n","combo_counter    = Counter() # (169,199) 같은 조합 통계용\n","label_len_counter = Counter()# 문서당 라벨 개수 분포\n","\n","for s in label_strs:\n","    s = s.strip(\",\")\n","    if not s:\n","        combo = ()\n","    else:\n","        # 콤마/공백 뭐가 와도 다 자르기: \"3 40,169\" -> [\"3\",\"40\",\"169\"]\n","        parts = re.split(r\"[,\\s]+\", s)\n","        parts = [x for x in parts if x != \"\"]\n","        combo = tuple(int(x) for x in parts)\n","\n","    if combo:\n","        combo_counter[combo] += 1\n","        label_len_counter[len(combo)] += 1\n","        all_labels_flat.extend(combo)\n","    else:\n","        label_len_counter[0] += 1\n","\n","# 1) 문서당 라벨 개수 분포\n","print(\"\\n=== 문서당 라벨 개수 분포 ===\")\n","for k in sorted(label_len_counter.keys()):\n","    print(f\"{k}개 라벨: {label_len_counter[k]} docs\")\n","\n","print(\"min labels/doc:\", min(label_len_counter.keys()))\n","print(\"max labels/doc:\", max(label_len_counter.keys()))\n","\n","# 2) 개별 라벨 기준 통계\n","single_counter = Counter(all_labels_flat)\n","unique_single_labels = sorted(single_counter.keys())\n","print(\"\\n=== 개별 라벨 기준 ===\")\n","print(\"고유 라벨 개수:\", len(unique_single_labels))\n","\n","TOTAL_CLASSES = 531\n","print(\"coverage(single):\",\n","      f\"{len(unique_single_labels)}/{TOTAL_CLASSES} = {len(unique_single_labels)/TOTAL_CLASSES:.3f}\")\n","\n","print(\"\\nTop 20 single labels:\")\n","for lid, c in single_counter.most_common(20):\n","    print(f\"{lid} : {c}\")\n","\n","# 3) 조합(세트) 기준 통계\n","print(\"\\n=== 라벨 조합 기준 (tuple 그대로) ===\")\n","print(\"고유 조합 개수:\", len(combo_counter))\n","\n","print(\"\\nTop 20 label combos:\")\n","for combo, c in combo_counter.most_common(20):\n","    print(f\"{','.join(map(str, combo))} : {c}\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BK1ZpY3UbwrU","executionInfo":{"status":"ok","timestamp":1764426288179,"user_tz":-540,"elapsed":112,"user":{"displayName":"이종원","userId":"01943472295623789309"}},"outputId":"cef0802a-7b13-4eb2-fcff-cc326b970143"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["=== 기본 정보 ===\n","행 개수 (docs): 19658\n","컬럼: ['id', 'label']\n","\n","=== 문서당 라벨 개수 분포 ===\n","2개 라벨: 11527 docs\n","3개 라벨: 8131 docs\n","min labels/doc: 2\n","max labels/doc: 3\n","\n","=== 개별 라벨 기준 ===\n","고유 라벨 개수: 341\n","coverage(single): 341/531 = 0.642\n","\n","Top 20 single labels:\n","3 : 3461\n","10 : 2257\n","34 : 1852\n","199 : 1304\n","11 : 1168\n","170 : 955\n","220 : 946\n","64 : 933\n","40 : 921\n","131 : 836\n","24 : 819\n","74 : 813\n","265 : 733\n","60 : 719\n","208 : 713\n","4 : 708\n","26 : 669\n","44 : 621\n","0 : 603\n","23 : 595\n","\n","=== 라벨 조합 기준 (tuple 그대로) ===\n","고유 조합 개수: 3016\n","\n","Top 20 label combos:\n","3,34 : 687\n","10,220,242 : 467\n","170,199 : 295\n","3,34,46 : 291\n","3,17,18 : 279\n","26,89 : 275\n","40,131,486 : 248\n","24,43 : 197\n","10,60 : 187\n","4,7,238 : 181\n","64,93 : 174\n","170,171,199 : 170\n","24,49 : 169\n","10,64,65 : 169\n","3,15 : 150\n","147,148 : 136\n","3,34,447 : 134\n","10,220 : 132\n","11,12 : 127\n","162,163 : 125\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"L4","machine_shape":"hm","provenance":[{"file_id":"1_wLl8Xzf0J5bV8pdB57A497xXIrbZur5","timestamp":1764426363440},{"file_id":"1Kgzvf4EbuYn1C_1NpG-s18mjOuBl0_Eb","timestamp":1764415897081},{"file_id":"1y0Ga3sFpYXRMaJYF3qLacOuUIZqfW08n","timestamp":1764242652480},{"file_id":"15dAga2dplq7upCE-InLuPXLZRfM8w-8G","timestamp":1764208054278}],"authorship_tag":"ABX9TyNJi0NLRz7v5rrVAcjkk2Jw"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"e29ebbe27ce0404b96e195ce1c95e1e4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_538583b362174f51ba5442afbff90f1b","IPY_MODEL_cc1bb5ac155d4e1b99011824a8f78c69","IPY_MODEL_07ee56e34fef46fbaec7bfcc7c18ba56"],"layout":"IPY_MODEL_2e0cba9caf0d4194b455f373ba6c1f3c"}},"538583b362174f51ba5442afbff90f1b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e0447209ed2a4453b244b83c472b0dbe","placeholder":"​","style":"IPY_MODEL_e5b5422e368a431ea84aa7496638591c","value":"modules.json: 100%"}},"cc1bb5ac155d4e1b99011824a8f78c69":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c741d24438a8436d8a3be575d605c71f","max":349,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d2afa5e35c3643aab85425386e9a04f9","value":349}},"07ee56e34fef46fbaec7bfcc7c18ba56":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_715dacdddb00445889cbc51ab9ccfb10","placeholder":"​","style":"IPY_MODEL_0aeb3a81211644f995311acdfd99417d","value":" 349/349 [00:00&lt;00:00, 43.8kB/s]"}},"2e0cba9caf0d4194b455f373ba6c1f3c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e0447209ed2a4453b244b83c472b0dbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e5b5422e368a431ea84aa7496638591c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c741d24438a8436d8a3be575d605c71f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2afa5e35c3643aab85425386e9a04f9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"715dacdddb00445889cbc51ab9ccfb10":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0aeb3a81211644f995311acdfd99417d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6c31101b384447dc86bfb1f4f9ec9c5d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9b048da7e0d349aebb24f70a68e24511","IPY_MODEL_69683a1dd384481e895eb0b3f002c06e","IPY_MODEL_97a2ae51d55a46c2b7b1368455d6af23"],"layout":"IPY_MODEL_b8f5342e646f4ff482eda6eab335373f"}},"9b048da7e0d349aebb24f70a68e24511":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2d175081ac664d47ae3ba0bc7be58bf5","placeholder":"​","style":"IPY_MODEL_2560348854d24233b2bef4b78a2605c9","value":"config_sentence_transformers.json: 100%"}},"69683a1dd384481e895eb0b3f002c06e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b02632cbc4804069913b6f2ffcaa1164","max":116,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4cea962048724743a0e08e1b9fe17541","value":116}},"97a2ae51d55a46c2b7b1368455d6af23":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9bcd255a9ce49f5be1c2e61feabd8a2","placeholder":"​","style":"IPY_MODEL_2dd551589d594bd18e9a749629310a98","value":" 116/116 [00:00&lt;00:00, 15.5kB/s]"}},"b8f5342e646f4ff482eda6eab335373f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2d175081ac664d47ae3ba0bc7be58bf5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2560348854d24233b2bef4b78a2605c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b02632cbc4804069913b6f2ffcaa1164":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4cea962048724743a0e08e1b9fe17541":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e9bcd255a9ce49f5be1c2e61feabd8a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2dd551589d594bd18e9a749629310a98":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"db5ecc016f9e481d8880043f623419e5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a8b59907a0944077a68214ce0a712c38","IPY_MODEL_2a75a82a7f504336b853c05ece3d4087","IPY_MODEL_a355eeb0034f4e45994b7468e48b4118"],"layout":"IPY_MODEL_949325ca64e04b33ada902ba0fffdd94"}},"a8b59907a0944077a68214ce0a712c38":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fd8eec3fc5584de5977838e497dc6a75","placeholder":"​","style":"IPY_MODEL_00e63ef08520468ab6f12915c49faf2e","value":"README.md: "}},"2a75a82a7f504336b853c05ece3d4087":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_96e544d213884a51a02ea12c59e162cc","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bf2d00af4326489992fcdae1ff644571","value":1}},"a355eeb0034f4e45994b7468e48b4118":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e155f2be8184a47b06fe10d7a6fb3ed","placeholder":"​","style":"IPY_MODEL_c7486402d8dc4429828627cbc9071c95","value":" 11.6k/? [00:00&lt;00:00, 1.39MB/s]"}},"949325ca64e04b33ada902ba0fffdd94":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fd8eec3fc5584de5977838e497dc6a75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00e63ef08520468ab6f12915c49faf2e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"96e544d213884a51a02ea12c59e162cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"bf2d00af4326489992fcdae1ff644571":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5e155f2be8184a47b06fe10d7a6fb3ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c7486402d8dc4429828627cbc9071c95":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fefa485e6f5748b69892fb7cd51dae6e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b2db65b79690488ca10f65c276b49b95","IPY_MODEL_52919e3c4fa64ee9b433ce3e9cd95dbe","IPY_MODEL_753e0f52551d48878d39302e53f80da0"],"layout":"IPY_MODEL_3d83f39d26b940b0a0f87a5a64566f15"}},"b2db65b79690488ca10f65c276b49b95":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a8ae745fcfde453296cb1bd2e0e31e22","placeholder":"​","style":"IPY_MODEL_bd23357b5aeb4f68bbc705ef1f313289","value":"sentence_bert_config.json: 100%"}},"52919e3c4fa64ee9b433ce3e9cd95dbe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_03cbda30478f4c01b0e2484bf1343f6e","max":53,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e1d861101641429db860fddd748be34e","value":53}},"753e0f52551d48878d39302e53f80da0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ede5cd450ac142cf8bdb92742d178d61","placeholder":"​","style":"IPY_MODEL_9086f8c709cd4e12b24ad7bb172ff91b","value":" 53.0/53.0 [00:00&lt;00:00, 6.60kB/s]"}},"3d83f39d26b940b0a0f87a5a64566f15":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a8ae745fcfde453296cb1bd2e0e31e22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd23357b5aeb4f68bbc705ef1f313289":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"03cbda30478f4c01b0e2484bf1343f6e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e1d861101641429db860fddd748be34e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ede5cd450ac142cf8bdb92742d178d61":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9086f8c709cd4e12b24ad7bb172ff91b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"37fa0890d59543ccbe5c3f02e220d11e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_482ac991658b40a2903945cd0906c804","IPY_MODEL_3405dc587e324b82bb87c27714827ba4","IPY_MODEL_95fed309fced4c11bf6c520ad8dd5332"],"layout":"IPY_MODEL_0a1db55e4c834ba7845081bee7982161"}},"482ac991658b40a2903945cd0906c804":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7a9fc2aaeff1437e8d85bba9e02fa39d","placeholder":"​","style":"IPY_MODEL_183a7983a919482a9feb067c160ce979","value":"config.json: 100%"}},"3405dc587e324b82bb87c27714827ba4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_014d31929e004222973c79fcff081938","max":571,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6239998adc964f14a0a46ef27d500592","value":571}},"95fed309fced4c11bf6c520ad8dd5332":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b53f16d756314227a44464cb12d287f8","placeholder":"​","style":"IPY_MODEL_bbf16e194db144dda8291d410515c9f2","value":" 571/571 [00:00&lt;00:00, 66.5kB/s]"}},"0a1db55e4c834ba7845081bee7982161":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a9fc2aaeff1437e8d85bba9e02fa39d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"183a7983a919482a9feb067c160ce979":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"014d31929e004222973c79fcff081938":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6239998adc964f14a0a46ef27d500592":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b53f16d756314227a44464cb12d287f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bbf16e194db144dda8291d410515c9f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"85efb8ee1c38448a9894c7b171309e32":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_559246501db341cc9bbab5ed14185af3","IPY_MODEL_41648c5c729243a59de746af390542c2","IPY_MODEL_183d680824d9445d9b03fa8b85d4e490"],"layout":"IPY_MODEL_b21c0675fb9445119f0e48fa3a83ffba"}},"559246501db341cc9bbab5ed14185af3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_98c9529ea33d45369007aadcabe64109","placeholder":"​","style":"IPY_MODEL_d18e3537a567406eaf60ad05afe0ad99","value":"model.safetensors: 100%"}},"41648c5c729243a59de746af390542c2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e80d2843809746cea81e36ea30a334a2","max":437971872,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d567920eb8ca43b5bf9b442ce12d5f2f","value":437971872}},"183d680824d9445d9b03fa8b85d4e490":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a3a9da1fc9f467a9bfaaa20b87d3f43","placeholder":"​","style":"IPY_MODEL_5a8c6c1527d4426292a244d5520aaea0","value":" 438M/438M [00:01&lt;00:00, 637MB/s]"}},"b21c0675fb9445119f0e48fa3a83ffba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98c9529ea33d45369007aadcabe64109":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d18e3537a567406eaf60ad05afe0ad99":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e80d2843809746cea81e36ea30a334a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d567920eb8ca43b5bf9b442ce12d5f2f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4a3a9da1fc9f467a9bfaaa20b87d3f43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a8c6c1527d4426292a244d5520aaea0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2619e17c7a97463cb95ffd11faa8ac51":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6e94b9d734aa486ba30e8603437d3cb3","IPY_MODEL_6a4a56fc991340f0bb0f66b64863063b","IPY_MODEL_044e10dddbd847a9abda79ecc1bfee09"],"layout":"IPY_MODEL_0ec17ec5adf64ed1aeccb766cd522201"}},"6e94b9d734aa486ba30e8603437d3cb3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_64193da487d646c2b6556127f3df77a3","placeholder":"​","style":"IPY_MODEL_349ada69d62c4e8b8ebfb74b88bc84e6","value":"tokenizer_config.json: 100%"}},"6a4a56fc991340f0bb0f66b64863063b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8953ba39413044fda208e16afcbdd943","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_13bd51fcdcba471a9f92be3e969742e0","value":363}},"044e10dddbd847a9abda79ecc1bfee09":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a2f424a2c854cf395a5afcff7d7b225","placeholder":"​","style":"IPY_MODEL_e8fe2f1e8514404f94e4d502c784246a","value":" 363/363 [00:00&lt;00:00, 44.6kB/s]"}},"0ec17ec5adf64ed1aeccb766cd522201":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"64193da487d646c2b6556127f3df77a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"349ada69d62c4e8b8ebfb74b88bc84e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8953ba39413044fda208e16afcbdd943":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"13bd51fcdcba471a9f92be3e969742e0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2a2f424a2c854cf395a5afcff7d7b225":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e8fe2f1e8514404f94e4d502c784246a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"43b97ccbf9cc429c8ff6f305180c72b4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_99a03c49df6c42fba02b9b2201c65849","IPY_MODEL_2de04f8818f24d92a10a22d2912127b8","IPY_MODEL_f8851858b3b848d79359c7dec79e5e0e"],"layout":"IPY_MODEL_88427a1b309548ada912ed02d308ca57"}},"99a03c49df6c42fba02b9b2201c65849":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a530937fcd664f9b9e3937894eb285fb","placeholder":"​","style":"IPY_MODEL_a6deed6dbb7a4d08aa164e3ffb033721","value":"vocab.txt: "}},"2de04f8818f24d92a10a22d2912127b8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_315d249fcf904124899f98c0c5417062","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bda45bb983e74b668659f9f2aae7f8f9","value":1}},"f8851858b3b848d79359c7dec79e5e0e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b08bd5ffa9c847b89d0a8410344dbb03","placeholder":"​","style":"IPY_MODEL_7864683a6fad41f99b2a63e0b2b2caee","value":" 232k/? [00:00&lt;00:00, 9.76MB/s]"}},"88427a1b309548ada912ed02d308ca57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a530937fcd664f9b9e3937894eb285fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a6deed6dbb7a4d08aa164e3ffb033721":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"315d249fcf904124899f98c0c5417062":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"bda45bb983e74b668659f9f2aae7f8f9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b08bd5ffa9c847b89d0a8410344dbb03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7864683a6fad41f99b2a63e0b2b2caee":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"07c20c5afc8b41c8b7e96e08ee84ffda":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_85942c1504ba4b7da78e797def970639","IPY_MODEL_5512dc4da5fd4225b0c138a7bb49493b","IPY_MODEL_f234908d00b6430f810fa6e06bd0942a"],"layout":"IPY_MODEL_db12ec1d0efd436481c9f60e2eeea5b0"}},"85942c1504ba4b7da78e797def970639":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_983f422d181646218912b6a126b8f790","placeholder":"​","style":"IPY_MODEL_f27abc9608b544139eff58e6718a5d14","value":"tokenizer.json: "}},"5512dc4da5fd4225b0c138a7bb49493b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0fa0332ab62d4f32828531a3b4afa812","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cb0e8286f4ed4398878bbaf8ef8c3a9a","value":1}},"f234908d00b6430f810fa6e06bd0942a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37850fe272b048b5964395e987cd7292","placeholder":"​","style":"IPY_MODEL_ece5cb7a476a43c594ea00875b0d5773","value":" 466k/? [00:00&lt;00:00, 32.5MB/s]"}},"db12ec1d0efd436481c9f60e2eeea5b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"983f422d181646218912b6a126b8f790":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f27abc9608b544139eff58e6718a5d14":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0fa0332ab62d4f32828531a3b4afa812":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"cb0e8286f4ed4398878bbaf8ef8c3a9a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"37850fe272b048b5964395e987cd7292":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ece5cb7a476a43c594ea00875b0d5773":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"eec62e206f7249e8b4be7120c27f5ecf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ead444bbbb3f47f8aa9d1e0f59e24621","IPY_MODEL_9110756ab23f4de0959c74ec87d56541","IPY_MODEL_6b55b951c222416ab318317602c7526a"],"layout":"IPY_MODEL_d093e89607234011a0446b241c44d452"}},"ead444bbbb3f47f8aa9d1e0f59e24621":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8cd7c26cb2e54fbcb20429426c08e534","placeholder":"​","style":"IPY_MODEL_ef72e7f9a2e54e6cb50db275688ba319","value":"special_tokens_map.json: 100%"}},"9110756ab23f4de0959c74ec87d56541":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a85e4644f974eb890bb6a8edd0d628f","max":239,"min":0,"orientation":"horizontal","style":"IPY_MODEL_427a62ed7bcf436fa6140a9c932044d5","value":239}},"6b55b951c222416ab318317602c7526a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_131d02df13734443b619964ce3c55bb2","placeholder":"​","style":"IPY_MODEL_d392029691a14bfc82b8fbef46bea23a","value":" 239/239 [00:00&lt;00:00, 31.5kB/s]"}},"d093e89607234011a0446b241c44d452":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8cd7c26cb2e54fbcb20429426c08e534":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef72e7f9a2e54e6cb50db275688ba319":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4a85e4644f974eb890bb6a8edd0d628f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"427a62ed7bcf436fa6140a9c932044d5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"131d02df13734443b619964ce3c55bb2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d392029691a14bfc82b8fbef46bea23a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3e72b7da61644ef5befb16df7111ba75":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_36fead8903064dc19517ef8b007579c4","IPY_MODEL_4d6479c572cd4e52a5b4d2ba5989d76f","IPY_MODEL_7250c2bb2cae4b34858ba82f4cf58325"],"layout":"IPY_MODEL_54e5e1e9e94f4556ac9dcf3c67bdf46e"}},"36fead8903064dc19517ef8b007579c4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b512ecd6e5a14bed84964fb8ab2688e1","placeholder":"​","style":"IPY_MODEL_cdb1ececb2594652b7e36b1b96a2eb64","value":"config.json: 100%"}},"4d6479c572cd4e52a5b4d2ba5989d76f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f574d6e4afb4e68b4398f2f34e747f6","max":190,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2910b7fce56841c783d6654e264eb708","value":190}},"7250c2bb2cae4b34858ba82f4cf58325":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ab65d8cf3eb746afa77fe3de1d17a53b","placeholder":"​","style":"IPY_MODEL_b0a2ae13a0e145b4a02383e34816cadd","value":" 190/190 [00:00&lt;00:00, 24.5kB/s]"}},"54e5e1e9e94f4556ac9dcf3c67bdf46e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b512ecd6e5a14bed84964fb8ab2688e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cdb1ececb2594652b7e36b1b96a2eb64":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6f574d6e4afb4e68b4398f2f34e747f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2910b7fce56841c783d6654e264eb708":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ab65d8cf3eb746afa77fe3de1d17a53b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b0a2ae13a0e145b4a02383e34816cadd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e06c45de4e714d6da1923b9fe54bcc99":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_72f60541067b41219f9e746e0100174f","IPY_MODEL_f09771b7b5534ae6a674158d4c30d40e","IPY_MODEL_bec5b5dc73504f6f892c34452ee0d7d0"],"layout":"IPY_MODEL_19c0206d635049c68c17f1ec71c4ea82"}},"72f60541067b41219f9e746e0100174f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f709a0c635e647839907d4c31c4d1561","placeholder":"​","style":"IPY_MODEL_d85847306cef418a808a265f62b6f950","value":"Batches: 100%"}},"f09771b7b5534ae6a674158d4c30d40e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ad85f4a94d154899a2fe9e3068962fa4","max":231,"min":0,"orientation":"horizontal","style":"IPY_MODEL_aa4341c5e397471688198cb873bb970b","value":231}},"bec5b5dc73504f6f892c34452ee0d7d0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5057fa911f83459c8993465b56918737","placeholder":"​","style":"IPY_MODEL_6b3664b79a2d4e8d94d926c9daed028c","value":" 231/231 [01:52&lt;00:00,  6.25it/s]"}},"19c0206d635049c68c17f1ec71c4ea82":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f709a0c635e647839907d4c31c4d1561":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d85847306cef418a808a265f62b6f950":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ad85f4a94d154899a2fe9e3068962fa4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa4341c5e397471688198cb873bb970b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5057fa911f83459c8993465b56918737":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6b3664b79a2d4e8d94d926c9daed028c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5c9ade92161c4fde9dac99a0e1e6e702":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8018edcfe6154a4dbbfac09f76f986c9","IPY_MODEL_e8f57431fe0f47f2b9464f55f8f33a66","IPY_MODEL_de56c96d8b814db982b7dd0626863b8f"],"layout":"IPY_MODEL_77ed78b43fef41af8ac780df78491042"}},"8018edcfe6154a4dbbfac09f76f986c9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3580f6972616471aa2a216c497ed1558","placeholder":"​","style":"IPY_MODEL_17df1942ff914667951a9026ab667a1d","value":"Batches: 100%"}},"e8f57431fe0f47f2b9464f55f8f33a66":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_30adac7befe847c8bb23a5f2b46dce31","max":143,"min":0,"orientation":"horizontal","style":"IPY_MODEL_184259816cca46c59f69dad34e70ad46","value":143}},"de56c96d8b814db982b7dd0626863b8f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6bf7cd082cd140dd8b79d9c963225399","placeholder":"​","style":"IPY_MODEL_7ab71a74fd5644288272410d6716e874","value":" 143/143 [01:08&lt;00:00,  6.06it/s]"}},"77ed78b43fef41af8ac780df78491042":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3580f6972616471aa2a216c497ed1558":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"17df1942ff914667951a9026ab667a1d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"30adac7befe847c8bb23a5f2b46dce31":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"184259816cca46c59f69dad34e70ad46":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6bf7cd082cd140dd8b79d9c963225399":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7ab71a74fd5644288272410d6716e874":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3a16008ab4ae4e229558c7fcb24925e1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9327a6b5eaa342a6944c3f3f8974741e","IPY_MODEL_69cc405f67b548459cd10182023cbc06","IPY_MODEL_0151f8bacbc24fdb8d14a8b3ed1fea61"],"layout":"IPY_MODEL_ae9ee1d69919495aae7cc23b00690b70"}},"9327a6b5eaa342a6944c3f3f8974741e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6406edd61cd949708f45333587e0ce5a","placeholder":"​","style":"IPY_MODEL_923fe8d2ac934d3594de86dc304ad7e6","value":"Batches: 100%"}},"69cc405f67b548459cd10182023cbc06":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9fbd388cc40640b5af67edd7a12854f4","max":16,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f20f6a5fc18f42c8918ddbea04744168","value":16}},"0151f8bacbc24fdb8d14a8b3ed1fea61":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_12cbbe5390f94f20aef2296585b230ca","placeholder":"​","style":"IPY_MODEL_51e6986fb3c6413ab35cd839659cb033","value":" 16/16 [00:07&lt;00:00,  4.21it/s]"}},"ae9ee1d69919495aae7cc23b00690b70":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6406edd61cd949708f45333587e0ce5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"923fe8d2ac934d3594de86dc304ad7e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9fbd388cc40640b5af67edd7a12854f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f20f6a5fc18f42c8918ddbea04744168":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"12cbbe5390f94f20aef2296585b230ca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"51e6986fb3c6413ab35cd839659cb033":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ac52f0e5152d4547934cb4065fc04295":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f644fedcccaa4a41b0340d00fcaee211","IPY_MODEL_ac726aca75cd413ca34fd2d1767b0bc0","IPY_MODEL_c71a43bbf0e542bca319d6e623701d6a"],"layout":"IPY_MODEL_2657aef281e54c14bdca4c61262b9c19"}},"f644fedcccaa4a41b0340d00fcaee211":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_600e560ad2344f21a7f40c2dd62eae54","placeholder":"​","style":"IPY_MODEL_9200830ed9a94df69dd72b4b569d7f61","value":"Batches: 100%"}},"ac726aca75cd413ca34fd2d1767b0bc0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_57ba8f02c7f84733b1f646a2cd11bf41","max":73,"min":0,"orientation":"horizontal","style":"IPY_MODEL_295dabe38401413287c8168101622242","value":73}},"c71a43bbf0e542bca319d6e623701d6a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_54b7f38b6f244a19b29d58e473b44136","placeholder":"​","style":"IPY_MODEL_4015c2219e4e4a6fbddeaddf71c6e8e6","value":" 73/73 [00:38&lt;00:00,  6.12it/s]"}},"2657aef281e54c14bdca4c61262b9c19":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"600e560ad2344f21a7f40c2dd62eae54":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9200830ed9a94df69dd72b4b569d7f61":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"57ba8f02c7f84733b1f646a2cd11bf41":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"295dabe38401413287c8168101622242":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"54b7f38b6f244a19b29d58e473b44136":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4015c2219e4e4a6fbddeaddf71c6e8e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d90d6bffe74f453faa650acacc9b334c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4295478e833c47d6ba6abaad1ed126fb","IPY_MODEL_e5f7124aa2784825a58f875bf022b056","IPY_MODEL_b966a2665c99400cb4d4b0b1cad4c581"],"layout":"IPY_MODEL_5d103d501bc844a48b88a139ecf0708a"}},"4295478e833c47d6ba6abaad1ed126fb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c078b21f1fcb456995901f24cc6a0b9b","placeholder":"​","style":"IPY_MODEL_7d11a3df7f67497dbd21164dd0a157f2","value":"Batches: 100%"}},"e5f7124aa2784825a58f875bf022b056":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_dceb9af0c06c47e896f1744f38d86ede","max":154,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9e043d67ecf049ef97695f1641d53bb2","value":154}},"b966a2665c99400cb4d4b0b1cad4c581":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0a0a5b1d0aa34602b5fa941df4516d8b","placeholder":"​","style":"IPY_MODEL_1579ff8e44b64d7485ffbcfbc9216483","value":" 154/154 [01:16&lt;00:00,  6.80it/s]"}},"5d103d501bc844a48b88a139ecf0708a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c078b21f1fcb456995901f24cc6a0b9b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7d11a3df7f67497dbd21164dd0a157f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dceb9af0c06c47e896f1744f38d86ede":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9e043d67ecf049ef97695f1641d53bb2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0a0a5b1d0aa34602b5fa941df4516d8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1579ff8e44b64d7485ffbcfbc9216483":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}